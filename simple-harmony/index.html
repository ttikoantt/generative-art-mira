<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Harmony - æ­£å¼¦æ³¢ã®èª¿å’Œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0a0f;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
        }

        .container {
            width: 100%;
            max-width: 1200px;
        }

        h1 {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #64b5f6, #ce93d8, #fff59d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .canvas-wrapper {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 16px;
            padding: 10px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .canvas-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(100, 181, 246, 0.1) 0%, transparent 70%);
            pointer-events: none;
        }

        #canvas {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 12px;
            cursor: pointer;
        }

        .controls {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .control-row:last-child {
            margin-bottom: 0;
        }

        label {
            min-width: 100px;
            color: #aaa;
            font-size: 0.85rem;
        }

        input[type="range"] {
            flex: 1;
            min-width: 150px;
            height: 6px;
            border-radius: 3px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #64b5f6, #ce93d8);
            cursor: pointer;
        }

        .value {
            min-width: 50px;
            text-align: right;
            color: #64b5f6;
            font-size: 0.85rem;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #64b5f6, #42a5f5);
            color: white;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(100, 181, 246, 0.3);
        }

        .info {
            text-align: center;
            color: #666;
            font-size: 0.8rem;
            padding: 10px;
        }

        .fullscreen-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
            z-index: 10;
        }

        .fullscreen-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.4rem;
            }

            .control-row {
                flex-direction: column;
                align-items: stretch;
            }

            label {
                margin-bottom: 5px;
            }

            input[type="range"] {
                width: 100%;
            }

            button {
                flex: 1;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒŠ Simple Harmony</h1>
        <p class="subtitle">æ­£å¼¦æ³¢ã®å¹²æ¸‰ãƒ‘ã‚¿ãƒ¼ãƒ³ - ã‚·ãƒ³ãƒ—ãƒ«ãªèª¿å’Œã®ç¾ã—ã•</p>

        <div class="canvas-wrapper">
            <button class="fullscreen-btn" onclick="toggleFullscreen()">â›¶</button>
            <canvas id="canvas"></canvas>
        </div>

        <div class="controls">
            <div class="control-row">
                <label>æ³¢ã®æ•°</label>
                <input type="range" id="waveCount" min="3" max="15" value="7">
                <span class="value" id="waveCountValue">7</span>
            </div>
            <div class="control-row">
                <label>æŒ¯å¹…</label>
                <input type="range" id="amplitude" min="20" max="100" value="50">
                <span class="value" id="amplitudeValue">50</span>
            </div>
            <div class="control-row">
                <label>å‘¨æ³¢æ•°</label>
                <input type="range" id="frequency" min="1" max="10" value="3">
                <span class="value" id="frequencyValue">3</span>
            </div>
            <div class="control-row">
                <label>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦</label>
                <input type="range" id="speed" min="1" max="20" value="5">
                <span class="value" id="speedValue">5</span>
            </div>
            <div class="control-row">
                <label>è‰²ç›¸</label>
                <input type="range" id="hue" min="0" max="360" value="200">
                <span class="value" id="hueValue">200Â°</span>
            </div>
        </div>

        <div class="button-group">
            <button class="btn-primary" onclick="randomize()">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ</button>
            <button class="btn-secondary" onclick="reset()">â†º ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="btn-secondary" onclick="toggleAnimation()">â¯ï¸ ä¸€æ™‚åœæ­¢</button>
        </div>

        <p class="info">ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã—ã¦æ³¢å½¢ã‚’ãƒªã‚»ãƒƒãƒˆ</p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // è¨­å®š
        let settings = {
            waveCount: 7,
            amplitude: 50,
            frequency: 3,
            speed: 5,
            hue: 200
        };

        let time = 0;
        let isAnimating = true;
        let animationId = null;

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºã®è¨­å®š
        function resizeCanvas() {
            const wrapper = canvas.parentElement;
            const size = Math.min(wrapper.clientWidth - 20, 800);
            canvas.width = size;
            canvas.height = size * 0.6;
        }

        // åˆæœŸåŒ–
        function init() {
            resizeCanvas();
            setupControls();
            animate();
        }

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®è¨­å®š
        function setupControls() {
            const controls = ['waveCount', 'amplitude', 'frequency', 'speed', 'hue'];
            controls.forEach(id => {
                const input = document.getElementById(id);
                const value = document.getElementById(id + 'Value');
                input.addEventListener('input', () => {
                    settings[id] = parseInt(input.value);
                    value.textContent = id === 'hue' ? input.value + 'Â°' : input.value;
                });
            });
        }

        // æ­£å¼¦æ³¢ã®ç”Ÿæˆ
        function sineWave(x, frequency, phase, amplitude) {
            return Math.sin(x * frequency + phase) * amplitude;
        }

        // è¤‡æ•°ã®æ­£å¼¦æ³¢ã®å¹²æ¸‰
        function interferencePattern(x, y, t) {
            let sum = 0;
            for (let i = 0; i < settings.waveCount; i++) {
                const freq = settings.frequency * 0.01 * (1 + i * 0.3);
                const phase = t * 0.001 * settings.speed + i * Math.PI * 2 / settings.waveCount;
                const amp = settings.amplitude * (1 - i * 0.05);
                sum += sineWave(x * 0.01, freq, phase, amp);
                sum += sineWave(y * 0.01, freq * 1.3, phase + Math.PI/4, amp * 0.7);
            }
            return sum / settings.waveCount;
        }

        // è‰²ã®ç”Ÿæˆ
        function getColor(value, baseHue) {
            const normalizedValue = (value + settings.amplitude) / (settings.amplitude * 2);
            const hue = (baseHue + normalizedValue * 60) % 360;
            const saturation = 70 + normalizedValue * 30;
            const lightness = 40 + normalizedValue * 30;
            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        }

        // æç”»
        function draw() {
            // èƒŒæ™¯ã‚’ã‚¯ãƒªã‚¢
            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const data = imageData.data;

            // ãƒ”ã‚¯ã‚»ãƒ«ã”ã¨ã«å¹²æ¸‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨ˆç®—
            for (let y = 0; y < canvas.height; y += 2) {
                for (let x = 0; x < canvas.width; x += 2) {
                    const value = interferencePattern(x, y, time);
                    const normalizedValue = (value + settings.amplitude) / (settings.amplitude * 2);

                    // HSLã‹ã‚‰RGBã«å¤‰æ›
                    const hue = (settings.hue + normalizedValue * 60) % 360;
                    const saturation = 0.7 + normalizedValue * 0.3;
                    const lightness = 0.3 + normalizedValue * 0.5;

                    const rgb = hslToRgb(hue / 360, saturation, lightness);

                    // 2x2ãƒ”ã‚¯ã‚»ãƒ«ãƒ–ãƒ­ãƒƒã‚¯
                    for (let dy = 0; dy < 2 && y + dy < canvas.height; dy++) {
                        for (let dx = 0; dx < 2 && x + dx < canvas.width; dx++) {
                            const idx = ((y + dy) * canvas.width + (x + dx)) * 4;
                            data[idx] = rgb[0];
                            data[idx + 1] = rgb[1];
                            data[idx + 2] = rgb[2];
                            data[idx + 3] = 255;
                        }
                    }
                }
            }

            ctx.putImageData(imageData, 0, 0);

            // æ³¢å½¢ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
            drawWaveOverlay();
        }

        // æ³¢å½¢ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
        function drawWaveOverlay() {
            ctx.lineWidth = 2;
            for (let i = 0; i < settings.waveCount; i++) {
                ctx.beginPath();
                const hue = (settings.hue + i * 30) % 360;
                ctx.strokeStyle = `hsla(${hue}, 70%, 60%, 0.5)`;

                for (let x = 0; x < canvas.width; x++) {
                    const freq = settings.frequency * 0.01 * (1 + i * 0.3);
                    const phase = time * 0.001 * settings.speed + i * Math.PI * 2 / settings.waveCount;
                    const amp = settings.amplitude * (1 - i * 0.05) * 0.5;
                    const y = canvas.height / 2 + sineWave(x * 0.01, freq, phase, amp);

                    if (x === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
            }
        }

        // HSLã‹ã‚‰RGBã«å¤‰æ›
        function hslToRgb(h, s, l) {
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
        function animate() {
            if (isAnimating) {
                draw();
                time += 16;
            }
            animationId = requestAnimationFrame(animate);
        }

        // ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ
        function randomize() {
            settings.waveCount = Math.floor(Math.random() * 10) + 3;
            settings.amplitude = Math.floor(Math.random() * 60) + 30;
            settings.frequency = Math.floor(Math.random() * 8) + 1;
            settings.hue = Math.floor(Math.random() * 360);

            updateControls();
        }

        // ãƒªã‚»ãƒƒãƒˆ
        function reset() {
            settings = {
                waveCount: 7,
                amplitude: 50,
                frequency: 3,
                speed: 5,
                hue: 200
            };
            time = 0;
            updateControls();
        }

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®æ›´æ–°
        function updateControls() {
            Object.keys(settings).forEach(key => {
                const input = document.getElementById(key);
                const value = document.getElementById(key + 'Value');
                if (input && value) {
                    input.value = settings[key];
                    value.textContent = key === 'hue' ? settings[key] + 'Â°' : settings[key];
                }
            });
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒˆã‚°ãƒ«
        function toggleAnimation() {
            isAnimating = !isAnimating;
            const btn = event.target;
            btn.textContent = isAnimating ? 'â¯ï¸ ä¸€æ™‚åœæ­¢' : 'â–¶ï¸ å†ç”Ÿ';
        }

        // å…¨ç”»é¢è¡¨ç¤º
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                canvas.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚¯ãƒªãƒƒã‚¯ã§ãƒªã‚»ãƒƒãƒˆ
        canvas.addEventListener('click', () => {
            time = 0;
        });

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚º
        window.addEventListener('resize', () => {
            resizeCanvas();
        });

        // åˆæœŸåŒ–å®Ÿè¡Œ
        init();
    </script>
</body>
</html>

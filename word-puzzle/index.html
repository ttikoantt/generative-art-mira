<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Puzzle | „ÉØ„Éº„Éâ„Éë„Ç∫„É´</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .game-container {
            text-align: center;
            padding: 20px;
            max-width: 600px;
            width: 100%;
        }

        h1 {
            color: #fff;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .stat {
            color: #fff;
            font-size: 1.2rem;
        }

        .stat span {
            color: #00ff87;
            font-weight: bold;
        }

        .target-word {
            color: #ffd93d;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: inline-block;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            max-width: 400px;
            margin: 0 auto 20px;
            touch-action: none;
        }

        .cell {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .cell.selected {
            background: rgba(0, 255, 135, 0.3);
            border-color: #00ff87;
            transform: scale(1.1);
        }

        .cell.correct {
            background: rgba(0, 255, 135, 0.5);
            border-color: #00ff87;
        }

        .cell.wrong {
            background: rgba(255, 107, 157, 0.5);
            border-color: #ff6b9d;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            .cell {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            .grid {
                gap: 5px;
            }
        }

        .message {
            color: #fff;
            font-size: 1.2rem;
            margin-top: 20px;
            padding: 15px 30px;
            background: rgba(0, 255, 135, 0.2);
            border-radius: 8px;
            display: none;
        }

        .message.show {
            display: inline-block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .fullscreen-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .clear-btn {
            padding: 10px 20px;
            background: rgba(255, 107, 157, 0.3);
            color: white;
            border: 1px solid rgba(255, 107, 157, 0.5);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }

        .clear-btn:hover {
            background: rgba(255, 107, 157, 0.5);
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">ÂÖ®ÁîªÈù¢</button>

    <div class="game-container">
        <h1>üî§ Word Puzzle</h1>

        <div class="stats">
            <div class="stat">„Çπ„Ç≥„Ç¢: <span id="score">0</span></div>
            <div class="stat">„É¨„Éô„É´: <span id="level">1</span></div>
        </div>

        <div class="target-word">Êé¢„ÅôÂçòË™û: <span id="target">APPLE</span></div>

        <div class="grid" id="grid"></div>

        <button class="clear-btn" onclick="clearSelection()">„ÇØ„É™„Ç¢</button>

        <div class="message" id="message"></div>
    </div>

    <script>
        const words = [
            'APPLE', 'BANANA', 'CHERRY', 'GRAPE', 'ORANGE',
            'LEMON', 'MANGO', 'PEACH', 'MELON', 'BERRY',
            'WATER', 'SUNNY', 'HAPPY', 'SMILE', 'DREAM',
            'MAGIC', 'LIGHT', 'STARS', 'CLOUD', 'OCEAN',
            'TIGER', 'LION', 'EAGLE', 'HORSE', 'SNAKE'
        ];

        let grid = [];
        let currentWord = '';
        let selectedCells = [];
        let score = 0;
        let level = 1;
        let targetWord = '';
        let isSelecting = false;

        // „Ç∞„É™„ÉÉ„ÉâÂàùÊúüÂåñ
        function initGrid() {
            const gridEl = document.getElementById('grid');
            gridEl.innerHTML = '';
            grid = [];
            selectedCells = [];
            currentWord = '';

            targetWord = words[Math.floor(Math.random() * words.length)];
            document.getElementById('target').textContent = targetWord;

            // „Çø„Éº„Ç≤„ÉÉ„ÉàÂçòË™û„ÇíÈÖçÁΩÆ
            const positions = [];
            let placed = false;

            while (!placed) {
                const startRow = Math.floor(Math.random() * 3);
                const startCol = Math.floor(Math.random() * 4);
                const direction = Math.random() > 0.5 ? 'h' : 'v';

                if (direction === 'h' && startCol + targetWord.length <= 6) {
                    for (let i = 0; i < targetWord.length; i++) {
                        positions.push({ row: startRow, col: startCol + i, letter: targetWord[i] });
                    }
                    placed = true;
                } else if (direction === 'v' && startRow + targetWord.length <= 6) {
                    for (let i = 0; i < targetWord.length; i++) {
                        positions.push({ row: startRow + i, col: startCol, letter: targetWord[i] });
                    }
                    placed = true;
                }
            }

            // „Ç∞„É™„ÉÉ„Éâ„Çí‰ΩúÊàê
            for (let row = 0; row < 6; row++) {
                grid[row] = [];
                for (let col = 0; col < 6; col++) {
                    const pos = positions.find(p => p.row === row && p.col === col);
                    const letter = pos ? pos.letter : getRandomLetter();

                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    cell.textContent = letter;
                    cell.addEventListener('mousedown', startSelect);
                    cell.addEventListener('mouseenter', continueSelect);
                    cell.addEventListener('touchstart', handleTouchStart);
                    cell.addEventListener('touchmove', handleTouchMove);

                    gridEl.appendChild(cell);
                    grid[row][col] = { letter, element: cell };
                }
            }

            document.addEventListener('mouseup', endSelect);
            document.addEventListener('touchend', endSelect);
        }

        function getRandomLetter() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            return letters[Math.floor(Math.random() * letters.length)];
        }

        function startSelect(e) {
            isSelecting = true;
            clearSelection();
            selectCell(e.target);
        }

        function continueSelect(e) {
            if (!isSelecting) return;
            selectCell(e.target);
        }

        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const element = document.elementFromPoint(touch.clientX, touch.clientY);
            if (element && element.classList.contains('cell')) {
                isSelecting = true;
                clearSelection();
                selectCell(element);
            }
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (!isSelecting) return;
            const touch = e.touches[0];
            const element = document.elementFromPoint(touch.clientX, touch.clientY);
            if (element && element.classList.contains('cell')) {
                selectCell(element);
            }
        }

        function selectCell(element) {
            const row = parseInt(element.dataset.row);
            const col = parseInt(element.dataset.col);

            if (!selectedCells.some(c => c.row === row && c.col === col)) {
                selectedCells.push({ row, col });
                element.classList.add('selected');
                currentWord += grid[row][col].letter;
            }
        }

        function endSelect() {
            if (!isSelecting) return;
            isSelecting = false;

            if (currentWord === targetWord) {
                // Ê≠£Ëß£
                selectedCells.forEach(({ row, col }) => {
                    grid[row][col].element.classList.add('correct');
                });
                showMessage('üéâ Ê≠£Ëß£ÔºÅ+10ÁÇπ');
                score += 10;
                level++;
                document.getElementById('score').textContent = score;
                document.getElementById('level').textContent = level;

                setTimeout(() => {
                    initGrid();
                }, 1500);
            } else if (currentWord.length > 0) {
                // ‰∏çÊ≠£Ëß£
                selectedCells.forEach(({ row, col }) => {
                    grid[row][col].element.classList.add('wrong');
                });
                showMessage('„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÔºÅ');

                setTimeout(() => {
                    selectedCells.forEach(({ row, col }) => {
                        grid[row][col].element.classList.remove('wrong', 'selected');
                    });
                    selectedCells = [];
                    currentWord = '';
                }, 1000);
            }
        }

        function clearSelection() {
            selectedCells.forEach(({ row, col }) => {
                grid[row][col].element.classList.remove('selected', 'wrong');
            });
            selectedCells = [];
            currentWord = '';
        }

        function showMessage(text) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.classList.add('show');
            setTimeout(() => {
                msg.classList.remove('show');
            }, 2000);
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // ÂàùÊúüÂåñ
        initGrid();
    </script>
</body>
</html>

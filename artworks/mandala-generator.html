<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generative Mandala | Mira</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
        }

        h1 {
            color: #fff;
            font-size: 1.5rem;
            margin-bottom: 10px;
            text-align: center;
        }

        canvas {
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: scale(0.95);
        }

        .info {
            color: #888;
            font-size: 0.9rem;
            margin-top: 15px;
            text-align: center;
        }

        @media (max-width: 600px) {
            canvas {
                max-width: 90vw;
                max-height: 90vw;
            }

            h1 {
                font-size: 1.2rem;
            }

            button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <h1>ğŸ”® Generative Mandala</h1>
    <canvas id="mandalaCanvas"></canvas>
    <div class="controls">
        <button id="generateBtn">æ–°ã—ã„ãƒãƒ³ãƒ€ãƒ©</button>
    </div>
    <p class="info">ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã§æ–°ã—ã„ãƒãƒ³ãƒ€ãƒ©ã‚’ç”Ÿæˆ</p>

    <script>
        const canvas = document.getElementById('mandalaCanvas');
        const ctx = canvas.getContext('2d');
        const generateBtn = document.getElementById('generateBtn');

        // Canvasã‚µã‚¤ã‚ºè¨­å®š
        const size = Math.min(window.innerWidth * 0.8, window.innerHeight * 0.6, 500);
        canvas.width = size;
        canvas.height = size;

        // HSVã‚’RGBã«å¤‰æ›
        function hsvToRgb(h, s, v) {
            let r, g, b;
            if (s === 0) {
                r = g = b = v;
                return [r, g, b];
            }

            h = h / 60;
            const i = Math.floor(h);
            const f = h - i;
            const p = v * (1 - s);
            const q = v * (1 - s * f);
            const t = v * (1 - s * (1 - f));

            switch (i % 6) {
                case 0: r = v; g = t; b = p; break;
                case 1: r = q; g = v; b = p; break;
                case 2: r = p; g = v; b = t; break;
                case 3: r = p; g = q; b = v; break;
                case 4: r = t; g = p; b = v; break;
                case 5: r = v; g = p; b = q; break;
            }

            return [r * 255, g * 255, b * 255];
        }

        // ãƒ©ãƒ³ãƒ€ãƒ æ•°å€¤ç”Ÿæˆ
        function random(min, max) {
            return Math.random() * (max - min) + min;
        }

        // ãƒ©ãƒ³ãƒ€ãƒ æ•´æ•°
        function randomInt(min, max) {
            return Math.floor(random(min, max + 1));
        }

        // ãƒãƒ³ãƒ€ãƒ©ã‚’æç”»
        function drawMandala() {
            // èƒŒæ™¯ã‚’ã‚¯ãƒªã‚¢
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const maxRadius = canvas.width / 2 - 20;

            // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ
            const segments = randomInt(6, 16);
            const layers = randomInt(5, 12);
            const baseHue = random(0, 360);
            const colorVar = random(0.1, 0.3);
            const lineWidth = random(1, 3);

            // å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æç”»
            for (let layer = 0; layer < layers; layer++) {
                const layerRatio = (layer + 1) / layers;
                const radius = maxRadius * layerRatio;
                const hue = (baseHue + layer * colorVar * 360) % 360;
                const saturation = random(0.5, 1);
                const value = random(0.6, 1);
                const alpha = random(0.3, 0.8);

                const [r, g, b] = hsvToRgb(hue, saturation, value);
                ctx.strokeStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`;
                ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${alpha * 0.3})`;
                ctx.lineWidth = lineWidth;

                // ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’æç”»
                for (let seg = 0; seg < segments; seg++) {
                    const angle1 = (seg / segments) * Math.PI * 2;
                    const angle2 = ((seg + 1) / segments) * Math.PI * 2;

                    ctx.save();
                    ctx.translate(centerX, centerY);

                    // å††å¼§
                    ctx.beginPath();
                    ctx.arc(0, 0, radius, angle1, angle2);
                    ctx.stroke();

                    // è£…é£¾è¦ç´ 
                    if (layer % 2 === 0) {
                        // å††
                        const decorX = Math.cos(angle1) * radius * 0.5;
                        const decorY = Math.sin(angle1) * radius * 0.5;
                        const decorSize = random(5, 15);

                        ctx.beginPath();
                        ctx.arc(decorX, decorY, decorSize, 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                        // èŠ±/æ˜Ÿ
                        const petalCount = randomInt(3, 8);
                        const petalSize = random(5, 20);

                        for (let petal = 0; petal < petalCount; petal++) {
                            const petalAngle = angle1 + (petal / petalCount) * (Math.PI / segments);

                            ctx.beginPath();
                            ctx.arc(
                                Math.cos(petalAngle) * radius * 0.5,
                                Math.sin(petalAngle) * radius * 0.5,
                                petalSize,
                                0,
                                Math.PI * 2
                            );
                            ctx.fill();
                        }
                    }

                    // ç·šè£…é£¾
                    const lineCount = randomInt(2, 5);
                    for (let line = 0; line < lineCount; line++) {
                        const lineAngle = angle1 + random(0, (Math.PI * 2) / segments);
                        const lineLength = random(radius * 0.3, radius * 0.7);

                        ctx.beginPath();
                        ctx.moveTo(0, 0);
                        ctx.lineTo(
                            Math.cos(lineAngle) * lineLength,
                            Math.sin(lineAngle) * lineLength
                        );
                        ctx.stroke();
                    }

                    ctx.restore();
                }

                // å¤–å´ã®å††
                if (layer === layers - 1) {
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius + 10, 0, Math.PI * 2);
                    ctx.strokeStyle = `rgba(${r}, ${g}, ${b}, 0.5)`;
                    ctx.lineWidth = lineWidth * 2;
                    ctx.stroke();
                }
            }

            // ä¸­å¿ƒã®å††
            const centerRadius = random(10, 30);
            const centerHue = (baseHue + 180) % 360;
            const [cr, cg, cb] = hsvToRgb(centerHue, 0.8, 1);
            ctx.beginPath();
            ctx.arc(centerX, centerY, centerRadius, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(${cr}, ${cg}, ${cb}, 0.8)`;
            ctx.fill();
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        function generate() {
            drawMandala();
        }

        generateBtn.addEventListener('click', generate);
        canvas.addEventListener('click', generate);

        // åˆæœŸæç”»
        generate();

        // ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
        window.addEventListener('resize', () => {
            const newSize = Math.min(window.innerWidth * 0.8, window.innerHeight * 0.6, 500);
            canvas.width = newSize;
            canvas.height = newSize;
            drawMandala();
        });
    </script>
</body>
</html>

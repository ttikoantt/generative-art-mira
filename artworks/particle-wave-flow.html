<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Wave Flow - Mira's Generative Art</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow: hidden;
        }

        .header {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 100;
        }

        .header h1 {
            color: white;
            font-size: 2rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            margin-bottom: 8px;
        }

        .header p {
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }

        canvas {
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            cursor: pointer;
        }

        .controls {
            position: fixed;
            bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .controls button {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .controls button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .controls button:active {
            transform: translateY(0);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåä Particle Wave Flow</h1>
        <p>„ÇØ„É™„ÉÉ„ÇØ„ÅßÊ≥¢Á¥ã„ÇíÂ∫É„Åí„Çã</p>
    </div>

    <canvas id="canvas"></canvas>

    <div class="controls">
        <button onclick="changeWaveMode('sine')">Ê≠£Âº¶Ê≥¢</button>
        <button onclick="changeWaveMode('noise')">„Éé„Ç§„Ç∫</button>
        <button onclick="changeWaveMode('spiral')">Ëû∫Êóã</button>
        <button onclick="resetParticles()">„É™„Çª„ÉÉ„Éà</button>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width = Math.min(window.innerWidth - 40, 900);
        let height = Math.min(window.innerHeight - 200, 600);
        canvas.width = width;
        canvas.height = height;

        const particles = [];
        const particleCount = 200;
        let waveMode = 'sine';
        let time = 0;
        let mouseX = width / 2;
        let mouseY = height / 2;
        let ripples = [];

        class Particle {
            constructor(x, y) {
                this.baseX = x;
                this.baseY = y;
                this.x = x;
                this.y = y;
                this.size = Math.random() * 3 + 1;
                this.hue = Math.random() * 60 + 180; // Èùí„ÄúÁ¥´
            }

            update(time, rippleX, rippleY, rippleStrength) {
                const dx = this.baseX - rippleX;
                const dy = this.baseY - rippleY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const waveOffset = Math.sin(distance * 0.02 - time) * rippleStrength;

                let offsetX = 0;
                let offsetY = 0;

                if (waveMode === 'sine') {
                    offsetX = Math.sin(this.baseX * 0.01 + time) * 30 + waveOffset;
                    offsetY = Math.cos(this.baseY * 0.01 + time) * 30;
                } else if (waveMode === 'noise') {
                    offsetX = Math.sin(this.baseX * 0.02 + time * 2) * 40;
                    offsetY = Math.cos(this.baseY * 0.02 + time * 1.5) * 40;
                } else if (waveMode === 'spiral') {
                    const angle = distance * 0.02 + time;
                    offsetX = Math.cos(angle) * 30;
                    offsetY = Math.sin(angle) * 30;
                }

                this.x = this.baseX + offsetX;
                this.y = this.baseY + offsetY;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${this.hue}, 80%, 60%, 0.8)`;
                ctx.fill();
            }
        }

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´ÂàùÊúüÂåñ
        for (let i = 0; i < particleCount; i++) {
            const x = (i % Math.sqrt(particleCount)) / Math.sqrt(particleCount) * width;
            const y = Math.floor(i / Math.sqrt(particleCount)) / Math.sqrt(particleCount) * height;
            particles.push(new Particle(x, y));
        }

        function changeWaveMode(mode) {
            waveMode = mode;
        }

        function resetParticles() {
            time = 0;
            ripples = [];
        }

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            ripples.push({
                x: e.clientX - rect.left,
                y: e.clientY - rect.top,
                strength: 50,
                time: 0
            });
        });

        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
        });

        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, width, height);

            time += 0.02;

            // Ê≥¢Á¥ã„ÇíÊõ¥Êñ∞
            ripples = ripples.filter(r => {
                r.time += 0.05;
                r.strength *= 0.98;
                return r.strength > 1;
            });

            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„ÇíÊõ¥Êñ∞„ÉªÊèèÁîª
            particles.forEach(particle => {
                let totalX = mouseX;
                let totalY = mouseY;
                let totalStrength = 30;

                ripples.forEach(r => {
                    totalX = r.x;
                    totalY = r.y;
                    totalStrength = r.strength;
                });

                particle.update(time, totalX, totalY, totalStrength);
                particle.draw();
            });

            // Ê≥¢Á¥ã„ÇíÊèèÁîª
            ripples.forEach(r => {
                ctx.beginPath();
                ctx.arc(r.x, r.y, r.time * 50, 0, Math.PI * 2);
                ctx.strokeStyle = `rgba(255, 255, 255, ${r.strength / 50})`;
                ctx.lineWidth = 2;
                ctx.stroke();
            });

            requestAnimationFrame(animate);
        }

        animate();

        // „Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫Â§âÊõ¥ÂØæÂøú
        window.addEventListener('resize', () => {
            width = Math.min(window.innerWidth - 40, 900);
            height = Math.min(window.innerHeight - 200, 600);
            canvas.width = width;
            canvas.height = height;
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurora Borealis - オーロラビジュアライザー</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(180deg, #000011 0%, #000022 50%, #000033 100%);
            min-height: 100vh;
            overflow: hidden;
            color: #00ffaa;
        }

        .container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: rgba(0, 10, 30, 0.7);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 170, 0.3);
            backdrop-filter: blur(10px);
            z-index: 10;
            max-width: 90%;
        }

        .control-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 140px;
        }

        .control label {
            font-size: 11px;
            color: #00ff88;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(0, 255, 170, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #00ff88;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px #00ff88;
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 10px 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: rgba(0, 255, 170, 0.15);
            border: 1px solid #00ff88;
            color: #00ff88;
            border-radius: 8px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
        }

        button:hover {
            background: rgba(0, 255, 170, 0.3);
            box-shadow: 0 0 20px rgba(0, 255, 170, 0.4);
        }

        .title {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            color: #00ffaa;
            text-shadow: 0 0 20px rgba(0, 255, 170, 0.8);
            letter-spacing: 3px;
            z-index: 10;
        }

        .fullscreen-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            background: rgba(0, 255, 170, 0.15);
            border: 1px solid #00ff88;
            color: #00ff88;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            z-index: 10;
            transition: all 0.3s;
        }

        .fullscreen-btn:hover {
            background: rgba(0, 255, 170, 0.3);
            box-shadow: 0 0 20px rgba(0, 255, 170, 0.4);
        }

        @media (max-width: 768px) {
            .title {
                font-size: 18px;
            }
            .controls {
                padding: 15px;
                bottom: 10px;
            }
            .control {
                min-width: 100px;
            }
            button {
                padding: 8px 12px;
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">AURORA BOREALIS</div>
        <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶</button>
        <canvas id="canvas"></canvas>

        <div class="controls">
            <div class="control-row">
                <div class="control">
                    <label>Wave Height: <span id="waveHeightValue">50</span></label>
                    <input type="range" id="waveHeight" min="20" max="100" value="50">
                </div>
                <div class="control">
                    <label>Wave Speed: <span id="waveSpeedValue">5</span></label>
                    <input type="range" id="waveSpeed" min="1" max="10" value="5">
                </div>
                <div class="control">
                    <label>Particle Count: <span id="particleCountValue">300</span></label>
                    <input type="range" id="particleCount" min="100" max="500" value="300">
                </div>
                <div class="control">
                    <label>Glow Intensity: <span id="glowIntensityValue">15</span></label>
                    <input type="range" id="glowIntensity" min="5" max="30" value="15">
                </div>
            </div>
            <div class="buttons">
                <button onclick="regenerate()">Generate New Aurora</button>
                <button onclick="toggleAnimation()">Pause/Resume</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let animationId;
        let isAnimating = true;

        // Parameters
        let waveHeight = 50;
        let waveSpeed = 5;
        let particleCount = 300;
        let glowIntensity = 15;

        // Aurora waves
        let waves = [];
        let particles = [];
        let stars = [];
        let time = 0;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        function init() {
            resize();
            generateAurora();
            generateStars();
        }

        function generateAurora() {
            waves = [];
            particles = [];
            time = 0;

            // Create aurora waves
            const waveCount = 5 + Math.floor(Math.random() * 4);
            for (let i = 0; i < waveCount; i++) {
                waves.push({
                    baseY: height * 0.3 + (i * height * 0.1),
                    amplitude: waveHeight * (0.5 + Math.random() * 0.5),
                    frequency: 0.002 + Math.random() * 0.003,
                    phase: Math.random() * Math.PI * 2,
                    speed: (0.5 + Math.random() * 0.5) * waveSpeed,
                    hue: 120 + Math.random() * 100, // Green to purple range
                    saturation: 70 + Math.random() * 30,
                    lightness: 40 + Math.random() * 20,
                    opacity: 0.3 + Math.random() * 0.4,
                    width: 80 + Math.random() * 120
                });
            }

            // Create particles
            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: Math.random() * width,
                    y: Math.random() * height * 0.7,
                    vx: (Math.random() - 0.5) * 0.5,
                    vy: (Math.random() - 0.5) * 0.5,
                    size: Math.random() * 2 + 1,
                    hue: 120 + Math.random() * 100,
                    opacity: Math.random() * 0.8,
                    pulse: Math.random() * Math.PI * 2
                });
            }
        }

        function generateStars() {
            stars = [];
            const starCount = 150;
            for (let i = 0; i < starCount; i++) {
                stars.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    size: Math.random() * 2,
                    opacity: Math.random(),
                    twinkleSpeed: 0.02 + Math.random() * 0.03
                });
            }
        }

        function drawBackground() {
            // Night sky gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, height);
            gradient.addColorStop(0, '#000011');
            gradient.addColorStop(0.5, '#000022');
            gradient.addColorStop(1, '#000033');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);
        }

        function drawStars() {
            stars.forEach(star => {
                star.opacity += Math.sin(Date.now() * star.twinkleSpeed) * 0.01;
                star.opacity = Math.max(0.1, Math.min(1, star.opacity));

                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
                ctx.fill();
            });
        }

        function drawAurora() {
            time += 0.016;

            waves.forEach((wave, index) => {
                ctx.beginPath();

                // Draw aurora curtain
                for (let x = 0; x <= width; x += 2) {
                    const y = wave.baseY +
                        Math.sin(x * wave.frequency + time * wave.speed + wave.phase) * wave.amplitude +
                        Math.sin(x * wave.frequency * 0.5 + time * wave.speed * 0.7) * wave.amplitude * 0.5;

                    if (x === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }

                // Close the path at the bottom
                ctx.lineTo(width, height);
                ctx.lineTo(0, height);
                ctx.closePath();

                // Create gradient
                const gradient = ctx.createLinearGradient(0, wave.baseY - wave.amplitude, 0, height);
                gradient.addColorStop(0, `hsla(${wave.hue}, ${wave.saturation}%, ${wave.lightness}%, ${wave.opacity})`);
                gradient.addColorStop(1, `hsla(${wave.hue + 20}, ${wave.saturation}%, ${wave.lightness * 0.5}%, 0)`);

                ctx.fillStyle = gradient;
                ctx.fill();

                // Add glow effect
                ctx.shadowBlur = glowIntensity;
                ctx.shadowColor = `hsla(${wave.hue}, 80%, 60%, 0.5)`;
            });

            ctx.shadowBlur = 0;
        }

        function drawParticles() {
            particles.forEach(particle => {
                // Update particle position
                particle.x += particle.vx;
                particle.y += particle.vy;

                // Wrap around
                if (particle.x < 0) particle.x = width;
                if (particle.x > width) particle.x = 0;
                if (particle.y < 0) particle.y = height * 0.7;
                if (particle.y > height * 0.7) particle.y = 0;

                // Pulse effect
                particle.pulse += 0.05;
                const pulseOpacity = particle.opacity + Math.sin(particle.pulse) * 0.3;

                // Draw particle
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${particle.hue}, 80%, 60%, ${pulseOpacity})`;
                ctx.shadowBlur = glowIntensity;
                ctx.shadowColor = `hsla(${particle.hue}, 80%, 60%, 0.8)`;
                ctx.fill();
            });

            ctx.shadowBlur = 0;
        }

        function draw() {
            drawBackground();
            drawStars();
            drawAurora();
            drawParticles();

            if (isAnimating) {
                animationId = requestAnimationFrame(draw);
            }
        }

        function regenerate() {
            generateAurora();
        }

        function toggleAnimation() {
            isAnimating = !isAnimating;
            if (isAnimating) {
                draw();
            }
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Event listeners for controls
        document.getElementById('waveHeight').addEventListener('input', (e) => {
            waveHeight = parseInt(e.target.value);
            document.getElementById('waveHeightValue').textContent = waveHeight;
        });

        document.getElementById('waveSpeed').addEventListener('input', (e) => {
            waveSpeed = parseInt(e.target.value);
            document.getElementById('waveSpeedValue').textContent = waveSpeed;
        });

        document.getElementById('particleCount').addEventListener('input', (e) => {
            particleCount = parseInt(e.target.value);
            document.getElementById('particleCountValue').textContent = particleCount;
        });

        document.getElementById('glowIntensity').addEventListener('input', (e) => {
            glowIntensity = parseInt(e.target.value);
            document.getElementById('glowIntensityValue').textContent = glowIntensity;
        });

        window.addEventListener('resize', () => {
            resize();
            generateStars();
        });

        // Initialize
        init();
        draw();
    </script>
</body>
</html>

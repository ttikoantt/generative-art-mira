<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜Ÿåº§ã‚¢ãƒ¼ãƒˆ - Constellation Art</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(to bottom, #0a0a1a, #1a1a3a);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Georgia', serif;
            overflow: hidden;
        }

        .container {
            text-align: center;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        h1 {
            color: #e0e0ff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(150, 150, 255, 0.5);
            letter-spacing: 0.3em;
        }

        .subtitle {
            color: #a0a0c0;
            font-size: 1rem;
            margin-bottom: 30px;
            font-style: italic;
        }

        #canvas {
            border-radius: 10px;
            box-shadow: 0 0 40px rgba(100, 100, 255, 0.3);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        #canvas:hover {
            transform: scale(1.02);
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #3a3a6a, #5a5a9a);
            color: #e0e0ff;
            border: 1px solid #6a6aaa;
            padding: 12px 30px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Georgia', serif;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(100, 100, 200, 0.3);
        }

        button:hover {
            background: linear-gradient(135deg, #5a5a9a, #7a7aba);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(100, 100, 200, 0.5);
        }

        .info {
            margin-top: 20px;
            color: #8080a0;
            font-size: 0.9rem;
            max-width: 500px;
        }

        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(60, 60, 100, 0.8);
            border: 1px solid #8080b0;
            color: #e0e0ff;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            background: rgba(80, 80, 120, 0.9);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .fullscreen-btn {
                top: 10px;
                right: 10px;
                width: 45px;
                height: 45px;
            }
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" onclick="toggleFullscreen()" title="å…¨ç”»é¢è¡¨ç¤º">â›¶</button>

    <div class="container">
        <h1>âœ¨ æ˜Ÿåº§ã‚¢ãƒ¼ãƒˆ âœ¨</h1>
        <p class="subtitle">Constellation Art - æ˜Ÿã®ç‰©èªã‚’ç´¡ã</p>

        <canvas id="canvas" width="700" height="500"></canvas>

        <div class="controls">
            <button onclick="generateConstellation()">ğŸŒŸ æ–°ã—ã„æ˜Ÿåº§</button>
            <button onclick="addStars()">âœ¨ æ˜Ÿã‚’è¿½åŠ </button>
            <button onclick="toggleAnimation()">ğŸ”„ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</button>
        </div>

        <p class="info">
            ã‚¯ãƒªãƒƒã‚¯ã§æ˜Ÿã‚’è¿½åŠ ã€ãƒ‰ãƒ©ãƒƒã‚°ã§æ˜Ÿåº§ã‚’ç¹‹ã’ã‚‹<br>
            ç‹¬è‡ªã®æ˜Ÿåº§ã‚’ä½œã£ã¦ã€å¤œç©ºã«ç‰©èªã‚’æã“ã†
        </p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let stars = [];
        let connections = [];
        let animationEnabled = true;
        let animationId = null;
        let selectedStars = [];

        // æ˜Ÿã®è‰²ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
        const starColors = [
            '#ffffff', '#ffffd4', '#ffffaa', '#ffd4d4',
            '#d4ffff', '#e0e0ff', '#fff0e0', '#f0e0ff'
        ];

        // æ˜Ÿåº§ã®åå‰
        const constellationNames = [
            'å¤©é¦¬', 'é»„é‡‘ã®ç›¾', 'å¤¢ã®èˆ¹', 'æ™‚ã®ç ‚', 'æ˜Ÿã®èˆ',
            'éŠ€æ²³ã®çŸ¢', 'æœˆã®ç³', 'å…‰ã®æ©‹', 'é¢¨ã®æ­Œ', 'å…‰ã®èˆŸ',
            'æ°¸é ã®ç‚', 'æ˜Ÿç©ºã®é“', 'å¤¢ã®éšæ®µ', 'æµæ˜Ÿã®è·¡', 'æ˜Ÿå±‘ã®å† '
        ];

        class Star {
            constructor(x, y, size = null) {
                this.x = x || Math.random() * canvas.width;
                this.y = y || Math.random() * canvas.height;
                this.size = size || (Math.random() * 2.5 + 0.5);
                this.color = starColors[Math.floor(Math.random() * starColors.length)];
                this.twinkle = Math.random() * Math.PI * 2;
                this.twinkleSpeed = Math.random() * 0.02 + 0.01;
                this.brightness = Math.random() * 0.5 + 0.5;
            }

            draw() {
                const twinkleBrightness = this.brightness * (0.7 + 0.3 * Math.sin(this.twinkle));

                ctx.save();
                ctx.beginPath();

                // å…‰ã‚‹åŠ¹æœ
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.size * 3
                );
                gradient.addColorStop(0, `rgba(255, 255, 255, ${twinkleBrightness})`);
                gradient.addColorStop(0.3, this.color);
                gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');

                ctx.fillStyle = gradient;
                ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
                ctx.fill();

                // æ˜Ÿã®æ ¸
                ctx.beginPath();
                ctx.fillStyle = `rgba(255, 255, 255, ${twinkleBrightness})`;
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();

                ctx.restore();

                if (animationEnabled) {
                    this.twinkle += this.twinkleSpeed;
                }
            }
        }

        function generateStars(count = 50) {
            stars = [];
            connections = [];
            selectedStars = [];

            // æ˜ã‚‹ã„æ˜Ÿï¼ˆä¸»è¦ãªæ˜Ÿï¼‰
            for (let i = 0; i < 8; i++) {
                stars.push(new Star(null, null, Math.random() * 1.5 + 1.5));
            }

            // å°ã•ãªæ˜Ÿ
            for (let i = 0; i < count; i++) {
                stars.push(new Star());
            }

            // è‡ªå‹•çš„ã«æ˜Ÿåº§ã‚’ç”Ÿæˆ
            generateConstellationLines();
        }

        function generateConstellationLines() {
            connections = [];

            // æ˜ã‚‹ã„æ˜ŸåŒå£«ã‚’ç¹‹ã
            const brightStars = stars.filter(s => s.size > 1.5);

            if (brightStars.length >= 3) {
                // æ˜Ÿåº§ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç”Ÿæˆ
                const patterns = [
                    // ä¸‰è§’å½¢å‹
                    () => {
                        connections.push([0, 1], [1, 2], [2, 0]);
                    },
                    // å››è§’å½¢å‹
                    () => {
                        if (brightStars.length >= 4) {
                            connections.push([0, 1], [1, 2], [2, 3], [3, 0]);
                        }
                    },
                    // é€£é–å‹
                    () => {
                        for (let i = 0; i < brightStars.length - 1; i++) {
                            connections.push([i, i + 1]);
                        }
                    }
                ];

                // ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é¸æŠ
                const pattern = patterns[Math.floor(Math.random() * patterns.length)];
                pattern();
            }
        }

        function drawConnections() {
            ctx.save();

            for (const [i, j] of connections) {
                if (stars[i] && stars[j]) {
                    const gradient = ctx.createLinearGradient(
                        stars[i].x, stars[i].y,
                        stars[j].x, stars[j].y
                    );
                    gradient.addColorStop(0, `rgba(200, 200, 255, 0.6)`);
                    gradient.addColorStop(0.5, `rgba(150, 150, 255, 0.4)`);
                    gradient.addColorStop(1, `rgba(200, 200, 255, 0.6)`);

                    ctx.beginPath();
                    ctx.strokeStyle = gradient;
                    ctx.lineWidth = 1.5;
                    ctx.moveTo(stars[i].x, stars[i].y);
                    ctx.lineTo(stars[j].x, stars[j].y);
                    ctx.stroke();
                }
            }

            // é¸æŠä¸­ã®æ˜Ÿã‚’ç¹‹ã
            if (selectedStars.length > 1) {
                const lastStar = selectedStars[selectedStars.length - 1];
                const prevStar = selectedStars[selectedStars.length - 2];

                ctx.beginPath();
                ctx.strokeStyle = 'rgba(255, 255, 100, 0.8)';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.moveTo(prevStar.x, prevStar.y);
                ctx.lineTo(lastStar.x, lastStar.y);
                ctx.stroke();
                ctx.setLineDash([]);
            }

            ctx.restore();
        }

        function drawBackground() {
            // èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#0a0a1a');
            gradient.addColorStop(0.5, #0f0f2a);
            gradient.addColorStop(1, '#1a1a3a');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // é ãã®å°ã•ãªæ˜Ÿã€…
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            for (let i = 0; i < 100; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = Math.random() * 0.5;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function drawConstellationName() {
            const brightStars = stars.filter(s => s.size > 1.5);
            if (brightStars.length >= 3) {
                // æ˜Ÿåº§ã®ä¸­å¿ƒã‚’è¨ˆç®—
                let centerX = 0, centerY = 0;
                brightStars.forEach(star => {
                    centerX += star.x;
                    centerY += star.y;
                });
                centerX /= brightStars.length;
                centerY /= brightStars.length;

                // æ˜Ÿåº§ã®åå‰ã‚’è¡¨ç¤º
                const name = constellationNames[Math.floor(Math.random() * constellationNames.length)];

                ctx.save();
                ctx.font = 'italic 16px Georgia';
                ctx.fillStyle = 'rgba(200, 200, 255, 0.7)';
                ctx.textAlign = 'center';
                ctx.fillText(name, centerX, centerY + 50);
                ctx.restore();
            }
        }

        function draw() {
            drawBackground();
            drawConnections();

            // æ˜Ÿã‚’æç”»
            stars.forEach(star => star.draw());

            drawConstellationName();

            if (animationEnabled) {
                animationId = requestAnimationFrame(draw);
            }
        }

        function generateConstellation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            generateStars();
            if (!animationEnabled) {
                draw();
            }
        }

        function addStars() {
            for (let i = 0; i < 10; i++) {
                stars.push(new Star());
            }
            if (!animationEnabled) {
                draw();
            }
        }

        function toggleAnimation() {
            animationEnabled = !animationEnabled;
            if (animationEnabled) {
                draw();
            }
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚¯ãƒªãƒƒã‚¯ã§æ˜Ÿã‚’è¿½åŠ 
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«è¿‘ã„æ˜Ÿã‚’æ¢ã™
            const nearbyStar = stars.find(star => {
                const dx = star.x - x;
                const dy = star.y - y;
                return Math.sqrt(dx * dx + dy * dy) < 20;
            });

            if (nearbyStar) {
                // æ—¢å­˜ã®æ˜Ÿã‚’é¸æŠ
                const starIndex = stars.indexOf(nearbyStar);
                if (!selectedStars.includes(starIndex)) {
                    selectedStars.push(starIndex);
                }

                // 3ã¤ä»¥ä¸Šé¸æŠã—ãŸã‚‰æ˜Ÿåº§ã‚’å®Œæˆã•ã›ã‚‹
                if (selectedStars.length >= 3) {
                    // æœ€å¾Œã®2ã¤ã®æ˜Ÿã‚’ç¹‹ã
                    const len = selectedStars.length;
                    connections.push([selectedStars[len - 2], selectedStars[len - 1]]);
                    selectedStars = [];
                }
            } else {
                // æ–°ã—ã„æ˜Ÿã‚’è¿½åŠ 
                stars.push(new Star(x, y, Math.random() * 1.5 + 1));
                if (!animationEnabled) {
                    draw();
                }
            }
        });

        // åˆæœŸåŒ–
        generateStars();
        draw();

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºèª¿æ•´
        function resizeCanvas() {
            const container = document.querySelector('.container');
            const maxWidth = Math.min(700, window.innerWidth - 40);
            const scale = maxWidth / 700;

            canvas.style.width = maxWidth + 'px';
            canvas.style.height = (500 * scale) + 'px';
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
    </script>
</body>
</html>

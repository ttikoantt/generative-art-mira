<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Noise Wave Field - ノイズ・ウェーブ・フィールド</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a0f;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }

        canvas {
            display: block;
        }

        .info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            z-index: 10;
            pointer-events: none;
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border-radius: 5px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .fullscreen {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="info">
        <div>Noise Wave Field</div>
        <div>Click to change wave frequency</div>
    </div>

    <button class="btn fullscreen" onclick="toggleFullscreen()">全画面</button>

    <div class="controls">
        <button class="btn" onclick="changePalette()">色変更</button>
        <button class="btn" onclick="resetAnimation()">リセット</button>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let time = 0;
        let waveFrequency = 0.02;
        let waveAmplitude = 50;

        const palettes = [
            { primary: [100, 200, 255], secondary: [150, 100, 255] },
            { primary: [255, 100, 150], secondary: [100, 200, 255] },
            { primary: [100, 255, 150], secondary: [255, 200, 100] },
            { primary: [255, 150, 50], secondary: [255, 100, 200] },
            { primary: [150, 255, 255], secondary: [255, 150, 255] }
        ];

        let currentPalette = 0;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        function noise(x, y, t) {
            const n1 = Math.sin(x * waveFrequency + t) * Math.cos(y * waveFrequency + t * 0.5);
            const n2 = Math.sin(x * waveFrequency * 2 + t * 1.5) * Math.sin(y * waveFrequency * 2 + t);
            const n3 = Math.cos((x + y) * waveFrequency * 0.5 + t * 0.8);
            
            return (n1 + n2 + n3) / 3;
        }

        function draw() {
            ctx.fillStyle = `rgba(10, 10, 15, 0.1)`;
            ctx.fillRect(0, 0, width, height);

            const palette = palettes[currentPalette];
            const gridSize = 20;
            
            for (let y = 0; y < height; y += gridSize) {
                for (let x = 0; x < width; x += gridSize) {
                    const n = noise(x, y, time);
                    const waveHeight = n * waveAmplitude;
                    
                    const brightness = (n + 1) / 2;
                    const r = Math.floor(palette.primary[0] * brightness + palette.secondary[0] * (1 - brightness));
                    const g = Math.floor(palette.primary[1] * brightness + palette.secondary[1] * (1 - brightness));
                    const b = Math.floor(palette.primary[2] * brightness + palette.secondary[2] * (1 - brightness));
                    
                    const alpha = brightness * 0.6;
                    
                    ctx.beginPath();
                    ctx.arc(x, y + waveHeight, gridSize * 0.4 * brightness, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`;
                    ctx.fill();
                }
            }

            time += 0.02;
            requestAnimationFrame(draw);
        }

        function changePalette() {
            currentPalette = (currentPalette + 1) % palettes.length;
        }

        function resetAnimation() {
            time = 0;
            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, width, height);
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        canvas.addEventListener('click', (e) => {
            waveFrequency = 0.01 + Math.random() * 0.04;
        });

        window.addEventListener('resize', resize);
        resize();
        draw();
    </script>
</body>
</html>

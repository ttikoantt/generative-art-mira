<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Chain - „ÉØ„Éº„Éâ„ÉÅ„Çß„Ç§„É≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a0033 0%, #330066 50%, #1a0033 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 600px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 50px rgba(138, 43, 226, 0.3);
        }

        h1 {
            color: #ff00ff;
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
        }

        .subtitle {
            color: #aaa;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat {
            background: rgba(138, 43, 226, 0.2);
            padding: 12px 20px;
            border-radius: 10px;
            text-align: center;
            flex: 1;
            min-width: 100px;
        }

        .stat-value {
            color: #00ffff;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .stat-label {
            color: #888;
            font-size: 12px;
            margin-top: 5px;
        }

        .word-history {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            max-height: 300px;
            overflow-y: auto;
            min-height: 150px;
        }

        .word-item {
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            font-size: 16px;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .word-item.player {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2), rgba(0, 128, 255, 0.2));
            border-left: 4px solid #00ffff;
            color: #00ffff;
        }

        .word-item.ai {
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.2), rgba(128, 0, 255, 0.2));
            border-left: 4px solid #ff00ff;
            color: #ff00ff;
        }

        .word-item .number {
            display: inline-block;
            width: 30px;
            color: #888;
            font-size: 14px;
        }

        .input-area {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-area input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid rgba(138, 43, 226, 0.5);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: #fff;
            font-size: 18px;
            transition: all 0.3s;
        }

        .input-area input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .input-area button {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #00ffff 0%, #0080ff 100%);
            color: #000;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .input-area button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
        }

        .input-area button:active {
            transform: translateY(0);
        }

        .message {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
            color: #ff6b6b;
        }

        .message.success {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            color: #00ff88;
        }

        .message.info {
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid rgba(138, 43, 226, 0.5);
            color: #d4a5ff;
        }

        .buttons {
            display: flex;
            gap: 10px;
        }

        .buttons button {
            flex: 1;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .buttons button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #ff00ff;
        }

        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .fullscreen-btn:hover {
            background: rgba(255, 0, 255, 0.2);
            border-color: #ff00ff;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a0033, #330066);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            border: 2px solid #ff00ff;
            box-shadow: 0 0 50px rgba(255, 0, 255, 0.5);
            animation: scaleIn 0.3s;
        }

        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-title {
            font-size: 36px;
            margin-bottom: 20px;
        }

        .modal-score {
            font-size: 48px;
            color: #00ffff;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
        }

        .modal-message {
            color: #aaa;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .modal-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #ff00ff, #8800ff);
            color: #fff;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 30px rgba(255, 0, 255, 0.6);
        }

        .hint {
            background: rgba(0, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #00ffff;
            border-left: 3px solid #00ffff;
        }

        .hint .last-word {
            font-weight: bold;
            color: #ff00ff;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .stats {
                gap: 10px;
            }

            .stat {
                padding: 10px 15px;
                min-width: 80px;
            }

            .stat-value {
                font-size: 22px;
            }

            .input-area {
                flex-direction: column;
            }

            .input-area button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" id="fullscreen">‚õ∂ ÂÖ®ÁîªÈù¢</button>

    <div class="game-container">
        <h1>üî§ „ÉØ„Éº„Éâ„ÉÅ„Çß„Ç§„É≥</h1>
        <p class="subtitle">„Åó„Çä„Å®„ÇäÂØæÊà¶„Ç≤„Éº„É†</p>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="currentChain">0</div>
                <div class="stat-label">ÁèæÂú®„ÅÆ„ÉÅ„Çß„Éº„É≥</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="bestChain">0</div>
                <div class="stat-label">„Éô„Çπ„Éà„ÉÅ„Çß„Éº„É≥</div>
            </div>
        </div>

        <div class="hint" id="hint">
            üí° Ââç„ÅÆÂçòË™û„ÅÆÊúÄÂæå„ÅÆÊñáÂ≠ó„ÅßÂßã„Åæ„ÇãÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠
        </div>

        <div class="word-history" id="wordHistory">
            <!-- „Ç≤„Éº„É†Â±•Ê≠¥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô -->
        </div>

        <div class="message" id="message" style="display: none;"></div>

        <div class="input-area">
            <input type="text" id="wordInput" placeholder="ÂçòË™û„ÇíÂÖ•ÂäõÔºà„Å≤„Çâ„Åå„Å™Ôºâ" maxlength="20">
            <button id="submitBtn">ÈÄÅ‰ø°</button>
        </div>

        <div class="buttons">
            <button id="restartBtn">üîÑ ÊúÄÂàù„Åã„Çâ</button>
            <button id="giveupBtn">üè≥Ô∏è Ë´¶„ÇÅ„Çã</button>
        </div>
    </div>

    <div class="modal" id="gameOverModal">
        <div class="modal-content">
            <div class="modal-title">üéÆ „Ç≤„Éº„É†„Ç™„Éº„Éê„Éº</div>
            <div class="modal-score" id="finalScore">0</div>
            <div class="modal-message" id="gameOverMessage">„ÉÅ„Çß„Éº„É≥Êï∞</div>
            <button class="modal-btn" id="restartModalBtn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§</button>
        </div>
    </div>

    <script>
        // Êó•Êú¨Ë™û„ÅÆÂçòË™û„É™„Çπ„ÉàÔºà„Ç∑„É≥„Éó„É´„Å™„É™„Çπ„ÉàÔºâ
        const wordList = [
            '„ÅÇ„ÅÑ', '„ÅÇ„Åä', '„ÅÇ„Åã', '„ÅÇ„Åç', '„ÅÇ„Åè', '„ÅÇ„Åë', '„ÅÇ„Åï', '„ÅÇ„Åó', '„ÅÇ„Åù', '„ÅÇ„Åü',
            '„ÅÇ„Å™', '„ÅÇ„Å´', '„ÅÇ„Å≠', '„ÅÇ„ÅÆ', '„ÅÇ„Å∞', '„ÅÇ„ÇÅ', '„ÅÇ„ÇÇ', '„ÅÇ„ÇÑ', '„ÅÇ„Çâ', '„ÅÇ„Çè',
            '„ÅÑ„Åà', '„ÅÑ„Åã', '„ÅÑ„Åç', '„ÅÑ„Åó', '„ÅÑ„Åô', '„ÅÑ„Åù', '„ÅÑ„Åü', '„ÅÑ„Å°', '„ÅÑ„Å¨', '„ÅÑ„ÅÆ',
            '„ÅÑ„ÇÇ', '„ÅÑ„ÇÑ', '„ÅÑ„Çä', '„ÅÑ„Çè', '„ÅÜ„Åà', '„ÅÜ„Åä', '„ÅÜ„Åã', '„ÅÜ„Åç', '„ÅÜ„Åï', '„ÅÜ„Åó',
            '„ÅÜ„Åù', '„ÅÜ„Å°', '„ÅÜ„Å§', '„ÅÜ„Åæ', '„ÅÜ„Åø', '„ÅÜ„ÇÅ', '„ÅÜ„Çâ', '„ÅÜ„Çã', '„ÅÜ„Çè', '„Åà„Åç',
            '„Åà„Å†', '„Åà„ÅÆ', '„Åà„Å≥', '„Åà„ÇÇ', '„Åà„Çâ', '„Åà„Çì', '„Åä„ÅÑ', '„Åä„ÅÜ', '„Åä„Åã', '„Åä„Åç',
            '„Åä„Åè', '„Åä„Åó', '„Åä„Åô', '„Åä„Åü', '„Åä„Å°', '„Åä„Å§', '„Åä„Å®', '„Åä„Å™', '„Åä„Å´', '„Åä„ÅÆ',
            '„Åä„Å∞', '„Åä„Åµ', '„Åä„Åº', '„Åä„Åæ', '„Åä„ÇÑ', '„Çà„Çã', '„Çâ„ÅÑ', '„Çâ„Åè', '„Çâ„Åè', '„Çâ„Åó',
            '„Çâ„Åü', '„Çâ„Å°', '„Çâ„Å§', '„Çâ„Å¶', '„Çâ„Å®', '„Çâ„Å™', '„Çâ„Å´', '„Çâ„Å¨', '„Çâ„Å≠', '„Çâ„ÅÆ',
            '„Çâ„ÅØ', '„Çâ„Å≤', '„Çâ„Åµ', '„Çâ„Å∏', '„Çâ„Åª', '„Çâ„Åæ', '„Çâ„Åø', '„Çâ„ÇÄ', '„Çâ„ÇÅ', '„Çâ„ÇÇ',
            '„Çâ„ÇÑ', '„Çâ„ÇÜ', '„Çâ„Çà', '„Çâ„Çâ', '„Çâ„Çä', '„Çâ„Çã', '„Çâ„Çå', '„Çâ„Çç', '„Çâ„Çè', '„Çâ„Çí',
            '„Çâ„Çì', '„Çä„ÅÑ', '„Çä„ÅÜ', '„Çä„Åà', '„Çä„Åä', '„Çä„Åã', '„Çä„Åç', '„Çä„Åè', '„Çä„Åë', '„Çä„Åì',
            '„Çä„Åï', '„Çä„Åó', '„Çä„Åô', '„Çä„Åõ', '„Çä„Åù', '„Çä„Åü', '„Çä„Å°', '„Çä„Å§', '„Çä„Å¶', '„Çä„Å®',
            '„Çä„Å™', '„Çä„Å´', '„Çä„Å¨', '„Çä„Å≠', '„Çä„ÅÆ', '„Çä„ÅØ', '„Çä„Å≤', '„Çä„Åµ', '„Çä„Å∏', '„Çä„Åª',
            '„Çä„Åæ', '„Çä„Åø', '„Çä„ÇÄ', '„Çä„ÇÅ', '„Çä„ÇÇ', '„Çä„ÇÑ', '„Çä„ÇÜ', '„Çä„Çà', '„Çä„Çâ', '„Çä„Çä',
            '„Çã„ÅÑ', '„Çã„ÅÜ', '„Çã„Åà', '„Çã„Åä', '„Çã„Åã', '„Çã„Åç', '„Çã„Åè', '„Çã„Åë', '„Çã„Åì', '„Çã„Åï',
            '„Çã„Åó', '„Çã„Åô', '„Çã„Åõ', '„Çã„Åù', '„Çã„Åü', '„Çã„Å°', '„Çã„Å§', '„Çã„Å¶', '„Çã„Å®', '„Çã„Å™',
            '„Çã„Å´', '„Çã„Å¨', '„Çã„Å≠', '„Çã„ÅÆ', '„Çã„ÅØ', '„Çã„Å≤', '„Çã„Åµ', '„Çã„Å∏', '„Çã„Åª', '„Çã„Åæ',
            '„Çã„Åø', '„Çã„ÇÄ', '„Çã„ÇÅ', '„Çã„ÇÇ', '„Çã„ÇÑ', '„Çã„ÇÜ', '„Çã„Çà', '„Çã„Çâ', '„Çã„Çä', '„Çã„Çã',
            '„Çå„ÅÑ', '„Çå„ÅÜ', '„Çå„Åà', '„Çå„Åä', '„Çå„Åã', '„Çå„Åç', '„Çå„Åè', '„Çå„Åë', '„Çå„Åì', '„Çå„Åï',
            '„Çå„Åó', '„Çå„Åô', '„Çå„Åõ', '„Çå„Åù', '„Çå„Åü', '„Çå„Å°', '„Çå„Å§', '„Çå„Å¶', '„Çå„Å®', '„Çå„Å™',
            '„Çå„Å´', '„Çå„Å¨', '„Çå„Å≠', '„Çå„ÅÆ', '„Çå„ÅØ', '„Çå„Å≤', '„Çå„Åµ', '„Çå„Å∏', '„Çå„Åª', '„Çå„Åæ',
            '„Çå„Åø', '„Çå„ÇÄ', '„Çå„ÇÅ', '„Çå„ÇÇ', '„Çå„ÇÑ', '„Çå„ÇÜ', '„Çå„Çà', '„Çå„Çâ', '„Çå„Çä', '„Çå„Çã',
            '„Çç„ÅÑ', '„Çç„ÅÜ', '„Çç„Åà', '„Çç„Åä', '„Çç„Åã', '„Çç„Åç', '„Çç„Åè', '„Çç„Åë', '„Çç„Åì', '„Çç„Åï',
            '„Çç„Åó', '„Çç„Åô', '„Çç„Åõ', '„Çç„Åù', '„Çç„Åü', '„Çç„Å°', '„Çç„Å§', '„Çç„Å¶', '„Çç„Å®', '„Çç„Å™',
            '„Çç„Å´', '„Çç„Å¨', '„Çç„Å≠', '„Çç„ÅÆ', '„Çç„ÅØ', '„Çç„Å≤', '„Çç„Åµ', '„Çç„Å∏', '„Çç„Åª', '„Çç„Åæ',
            '„Çç„Åø', '„Çç„ÇÄ', '„Çç„ÇÅ', '„Çç„ÇÇ', '„Çç„ÇÑ', '„Çç„ÇÜ', '„Çç„Çà', '„Çç„Çâ', '„Çç„Çä', '„Çç„Çã',
            '„Çè„ÅÑ', '„Çè„ÅÜ', '„Çè„Åà', '„Çè„Åä', '„Çè„Åã', '„Çè„Åç', '„Çè„Åè', '„Çè„Åë', '„Çè„Åì', '„Çè„Åï',
            '„Çè„Åó', '„Çè„Åô', '„Çè„Åõ', '„Çè„Åù', '„Çè„Åü', '„Çè„Å°', '„Çè„Å§', '„Çè„Å¶', '„Çè„Å®', '„Çè„Å™',
            '„Çè„Å´', '„Çè„Å¨', '„Çè„Å≠', '„Çè„ÅÆ', '„Çè„ÅØ', '„Çè„Å≤', '„Çè„Åµ', '„Çè„Å∏', '„Çè„Åª', '„Çè„Åæ',
            '„Çè„Åø', '„Çè„ÇÄ', '„Çè„ÇÅ', '„Çè„ÇÇ', '„Çè„ÇÑ', '„Çè„ÇÜ', '„Çè„Çà', '„Çè„Çâ', '„Çè„Çä', '„Çè„Çã',
            '„Çí„ÅÑ', '„Çí„Åä', '„Çí„Åã', '„Çí„Åç', '„Çí„Åè', '„Çí„Åë', '„Çí„Åì', '„Çí„Åï', '„Çí„Åó', '„Çí„Åô',
            '„Çí„Åõ', '„Çí„Åù', '„Çí„Åü', '„Çí„Å°', '„Çí„Å§', '„Çí„Å¶', '„Çí„Å®', '„Çí„Å™', '„Çí„Å´', '„Çí„Å¨',
            '„Çí„Å≠', '„Çí„ÅÆ', '„Çí„ÅØ', '„Çí„Å≤', '„Çí„Åµ', '„Çí„Å∏', '„Çí„Åª', '„Çí„Åæ', '„Çí„Åø', '„Çí„ÇÄ',
            '„Çí„ÇÅ', '„Çí„ÇÇ', '„Çí„ÇÑ', '„Çí„ÇÜ', '„Çí„Çà', '„Çí„Çâ', '„Çí„Çä', '„Çí„Çã', '„Çí„Çå', '„Çí„Çç',
            '„Çì„ÅÇ', '„Çì„ÅÑ', '„Çì„ÅÜ', '„Çì„Åà', '„Çì„Åä', '„Çì„Åã', '„Çì„Åç', '„Çì„Åè', '„Çì„Åë', '„Çì„Åì',
            '„Çì„Åï', '„Çì„Åó', '„Çì„Åô', '„Çì„Åõ', '„Çì„Åù', '„Çì„Åü', '„Çì„Å°', '„Çì„Å§', '„Çì„Å¶', '„Çì„Å®',
            '„Çì„Å™', '„Çì„Å´', '„Çì„Å¨', '„Çì„Å≠', '„Çì„ÅÆ', '„Çì„ÅØ', '„Çì„Å≤', '„Çì„Åµ', '„Çì„Å∏', '„Çì„Åª',
            '„Çì„Åæ', '„Çì„Åø', '„Çì„ÇÄ', '„Çì„ÇÅ', '„Çì„ÇÇ', '„Çì„ÇÑ', '„Çì„ÇÜ', '„Çì„Çà', '„Çì„Çâ', '„Çì„Çä',
            '„Çã„Çå', '„Çã„Çç', '„Çå„Çí', '„Çå„Çì', '„Çç„ÅÜ', '„Çç„Çè', '„Çç„Çí', '„Çç„Çì', '„Çè„ÅÑ', '„Çè„ÅÜ'
        ];

        // „Ç≤„Éº„É†Áä∂ÊÖã
        let wordHistory = [];
        let lastWord = '';
        let gameOver = false;
        let bestChain = parseInt(localStorage.getItem('wordChainBest')) || 0;

        // DOMË¶ÅÁ¥†
        const currentChainEl = document.getElementById('currentChain');
        const bestChainEl = document.getElementById('bestChain');
        const wordHistoryEl = document.getElementById('wordHistory');
        const wordInput = document.getElementById('wordInput');
        const messageEl = document.getElementById('message');
        const hintEl = document.getElementById('hint');
        const gameOverModal = document.getElementById('gameOverModal');
        const finalScoreEl = document.getElementById('finalScore');
        const gameOverMessageEl = document.getElementById('gameOverMessage');

        // ÂàùÊúüÂåñ
        function init() {
            bestChainEl.textContent = bestChain;
            wordInput.focus();

            // AI„ÅåÊúÄÂàù„ÅÆÂçòË™û„ÇíÂá∫„Åô
            setTimeout(() => {
                const firstWord = getRandomStartingWord();
                addWord(firstWord, 'ai');
                showMessage('AI„Åå„Çπ„Çø„Éº„ÉàÔºÅ', 'info');
            }, 500);
        }

        function getRandomStartingWord() {
            const startingWords = ['„ÅÇ„ÅÑ', '„ÅÇ„Åä', '„ÅÇ„Åã', '„ÅÜ„Åæ', '„Åà„Åç', '„Åä„Åã', '„Åã„Åç', '„Åç„Åó', '„Åè„Åæ', '„Åë„Åó', '„Åì„Åà', '„Åï„Åã„Å™', '„Åó„Åã', '„Åô„Åó', '„Åõ„Åã„ÅÑ', '„Åù„Çâ', '„Åü„Åì', '„Å°„Åö', '„Å§„Åç', '„Å¶„Åå„Åø', '„Å®„Çä', '„Å™„Å§', '„Å´„Åè', '„Å¨„ÅÑ„Åê„Çã„Åø', '„Å≠„Åì', '„ÅÆ„Åû„Åø', '„ÅØ„Å™', '„Å≤„Å®', '„Åµ„Åò', '„Å∏„ÇÑ', '„Åª„Åó', '„Åæ„Å©', '„Åø„Åö', '„ÇÄ„Åó', '„ÇÅ„Åå„Å≠', '„ÇÇ„Çä', '„ÇÑ„Åæ', '„ÇÜ„Åç', '„Çà„Çã', '„Çâ„ÅÑ„Å≠„Çì', '„Çã„Åô', '„Çå„ÅÑ„Åû„ÅÜ„Åì', '„Çç„ÅÜ„Åù„Åè', '„Çè„Å´'];
            return startingWords[Math.floor(Math.random() * startingWords.length)];
        }

        function addWord(word, player) {
            wordHistory.push({ word, player });
            lastWord = word;

            const wordItem = document.createElement('div');
            wordItem.className = `word-item ${player}`;
            wordItem.innerHTML = `<span class="number">${wordHistory.length}.</span> ${word}`;
            wordHistoryEl.appendChild(wordItem);
            wordHistoryEl.scrollTop = wordHistoryEl.scrollHeight;

            currentChainEl.textContent = wordHistory.length;

            updateHint();
        }

        function updateHint() {
            if (lastWord) {
                const lastChar = lastWord.slice(-1);
                hintEl.innerHTML = `üí° „Äå${lastWord}„Äç„ÅßÁµÇ„Çè„Å£„ÅüÔºÅÊ¨°„ÅØ„Äå${lastChar}„Äç„ÅßÂßã„Åæ„ÇãÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠`;
            } else {
                hintEl.innerHTML = `üí° Ââç„ÅÆÂçòË™û„ÅÆÊúÄÂæå„ÅÆÊñáÂ≠ó„ÅßÂßã„Åæ„ÇãÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠`;
            }
        }

        function showMessage(text, type = 'info') {
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;
            messageEl.style.display = 'block';

            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }

        function validateWord(word) {
            // „Å≤„Çâ„Åå„Å™„ÉÅ„Çß„ÉÉ„ÇØ
            if (!/^[\u3040-\u309F]+$/.test(word)) {
                return { valid: false, message: '„Å≤„Çâ„Åå„Å™„ÅßÂÖ•Âäõ„Åó„Å¶„Å≠ÔºÅ' };
            }

            // Èï∑„Åï„ÉÅ„Çß„ÉÉ„ÇØ
            if (word.length < 2) {
                return { valid: false, message: '2ÊñáÂ≠ó‰ª•‰∏ä„ÅÆÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠ÔºÅ' };
            }

            // „Åó„Çä„Å®„Çä„É´„Éº„É´„ÉÅ„Çß„ÉÉ„ÇØ
            if (lastWord) {
                const lastChar = lastWord.slice(-1);
                const firstChar = word.slice(0, 1);

                if (lastChar !== firstChar) {
                    return { valid: false, message: `„Äå${lastChar}„Äç„ÅßÂßã„Åæ„ÇãÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠ÔºÅ` };
                }
            }

            // ÈáçÂ§ç„ÉÅ„Çß„ÉÉ„ÇØ
            if (wordHistory.some(item => item.word === word)) {
                return { valid: false, message: '„Åù„ÅÆÂçòË™û„ÅØ„ÇÇ„ÅÜ‰Ωø„Å£„Åü„ÇàÔºÅ' };
            }

            // „Äå„Çì„Äç„ÅßÁµÇ„Çè„Çã„ÉÅ„Çß„ÉÉ„ÇØ
            if (word.endsWith('„Çì')) {
                return { valid: false, message: '„Äå„Çì„Äç„ÅßÁµÇ„Çè„ÇãÂçòË™û„ÅØ„ÉÄ„É°ÔºÅ' };
            }

            return { valid: true };
        }

        function getAIWord() {
            if (!lastWord) return getRandomStartingWord();

            const lastChar = lastWord.slice(-1);
            const candidates = wordList.filter(word =>
                word.startsWith(lastChar) &&
                !wordHistory.some(item => item.word === word) &&
                !word.endsWith('„Çì')
            );

            if (candidates.length === 0) {
                return null; // AI„ÅåË≤†„Åë
            }

            return candidates[Math.floor(Math.random() * candidates.length)];
        }

        function submitWord() {
            if (gameOver) return;

            const word = wordInput.value.trim();

            if (!word) {
                showMessage('ÂçòË™û„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠ÔºÅ', 'error');
                return;
            }

            const validation = validateWord(word);

            if (!validation.valid) {
                showMessage(validation.message, 'error');
                return;
            }

            // „Éó„É¨„Ç§„É§„Éº„ÅÆÂçòË™û„ÇíËøΩÂä†
            addWord(word, 'player');
            wordInput.value = '';

            // AI„ÅÆ„Çø„Éº„É≥
            setTimeout(() => {
                const aiWord = getAIWord();

                if (!aiWord) {
                    endGame(true); // „Éó„É¨„Ç§„É§„Éº„ÅÆÂãù„Å°
                    return;
                }

                addWord(aiWord, 'ai');
                showMessage(`AI: ${aiWord}`, 'success');
            }, 800);
        }

        function endGame(playerWins) {
            gameOver = true;
            const chainCount = wordHistory.length;

            if (chainCount > bestChain) {
                bestChain = chainCount;
                localStorage.setItem('wordChainBest', bestChain);
                bestChainEl.textContent = bestChain;
            }

            finalScoreEl.textContent = chainCount;

            if (playerWins) {
                gameOverMessageEl.textContent = 'üéâ „Åä„ÇÅ„Åß„Å®„ÅÜÔºÅAI„Å´Âãù„Å£„ÅüÔºÅ';
            } else {
                gameOverMessageEl.textContent = 'üò¢ ÊÆãÂøµÔºÅAI„ÅÆÂãù„Å°ÔºÅ';
            }

            gameOverModal.classList.add('active');
        }

        function restart() {
            wordHistory = [];
            lastWord = '';
            gameOver = false;
            wordHistoryEl.innerHTML = '';
            currentChainEl.textContent = '0';
            updateHint();
            gameOverModal.classList.remove('active');

            setTimeout(() => {
                const firstWord = getRandomStartingWord();
                addWord(firstWord, 'ai');
                showMessage('Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†„Çπ„Çø„Éº„ÉàÔºÅ', 'info');
            }, 500);
        }

        function giveup() {
            if (wordHistory.length === 0) return;
            endGame(false);
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('submitBtn').addEventListener('click', submitWord);

        wordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                submitWord();
            }
        });

        document.getElementById('restartBtn').addEventListener('click', restart);
        document.getElementById('giveupBtn').addEventListener('click', giveup);
        document.getElementById('restartModalBtn').addEventListener('click', restart);

        document.getElementById('fullscreen').addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });

        // ÂàùÊúüÂåñÂÆüË°å
        init();
    </script>
</body>
</html>

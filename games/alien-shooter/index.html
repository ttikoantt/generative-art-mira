<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>„Ç®„Ç§„É™„Ç¢„É≥„Éª„Ç∑„É•„Éº„Çø„Éº</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Press Start 2P', 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            overflow: hidden;
        }

        h1 {
            color: #0ff;
            font-size: clamp(1.2rem, 4vw, 2rem);
            margin-bottom: 5px;
            text-align: center;
            text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff; }
            to { text-shadow: 0 0 20px #0ff, 0 0 40px #0ff, 0 0 60px #0ff; }
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 600px;
            color: #0f0;
            font-size: clamp(0.7rem, 2vw, 0.9rem);
            margin-bottom: 10px;
        }

        .canvas-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            aspect-ratio: 3/4;
            background: #000;
            border: 3px solid #0ff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
        }

        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            cursor: crosshair;
        }

        .fullscreen-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #0ff;
            color: #0ff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            background: rgba(0, 255, 255, 0.2);
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #0ff;
            z-index: 100;
        }

        .overlay.hidden {
            display: none;
        }

        .overlay h2 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            margin-bottom: 20px;
            text-shadow: 0 0 20px #0ff;
        }

        .overlay p {
            font-size: clamp(0.8rem, 2.5vw, 1.2rem);
            margin-bottom: 30px;
            text-align: center;
            line-height: 1.6;
        }

        .start-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            background: transparent;
            border: 3px solid #0f0;
            color: #0f0;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .start-btn:hover {
            background: #0f0;
            color: #000;
            box-shadow: 0 0 30px #0f0;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 600px;
            margin-top: 10px;
        }

        .stat {
            text-align: center;
            color: #0f0;
            font-size: 0.8rem;
        }

        .stat-value {
            font-size: 1.2rem;
            color: #0ff;
        }

        @media (max-width: 600px) {
            .canvas-container {
                aspect-ratio: 2/3;
            }
        }
    </style>
</head>
<body>
    <h1>üëæ „Ç®„Ç§„É™„Ç¢„É≥„Éª„Ç∑„É•„Éº„Çø„Éº</h1>

    <div class="game-info">
        <div>„Çπ„Ç≥„Ç¢: <span id="scoreDisplay">0</span></div>
        <div>„É©„Ç§„Éï: <span id="livesDisplay">3</span></div>
    </div>

    <div class="canvas-container" id="canvasContainer">
        <button class="fullscreen-btn" id="fullscreenBtn">‚õ∂</button>
        <canvas id="gameCanvas"></canvas>

        <div class="overlay" id="startOverlay">
            <h2>üëæ ALIEN SHOOTER</h2>
            <p>„Çø„ÉÉ„Éó/„ÇØ„É™„ÉÉ„ÇØ„Åß„Ç®„Ç§„É™„Ç¢„É≥„ÇíÊíÉ„Å¶ÔºÅ<br>„Ç®„Ç§„É™„Ç¢„É≥„Åå‰∏ã„Å´Âà∞ÈÅî„Åô„Çã„Å®„ÉÄ„É°„Éº„Ç∏</p>
            <button class="start-btn" id="startBtn">START GAME</button>
        </div>

        <div class="overlay hidden" id="gameOverOverlay">
            <h2>GAME OVER</h2>
            <p>ÊúÄÁµÇ„Çπ„Ç≥„Ç¢: <span id="finalScore">0</span></p>
            <button class="start-btn" id="restartBtn">RESTART</button>
        </div>
    </div>

    <div class="stats">
        <div class="stat">
            <div>„Éè„Ç§„Çπ„Ç≥„Ç¢</div>
            <div class="stat-value" id="highScore">0</div>
        </div>
        <div class="stat">
            <div>ÊíÉÁ†¥Êï∞</div>
            <div class="stat-value" id="kills">0</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('canvasContainer');

        let width, height;
        let gameRunning = false;
        let score = 0;
        let lives = 3;
        let kills = 0;
        let highScore = localStorage.getItem('alienShooterHighScore') || 0;

        let player = { x: 0, y: 0, width: 40, height: 40 };
        let bullets = [];
        let aliens = [];
        let particles = [];
        let powerUps = [];

        let alienSpawnRate = 60;
        let alienSpawnTimer = 0;
        let difficultyLevel = 1;

        // Ëâ≤„ÅÆÂÆöÁæ©
        const colors = {
            player: '#0ff',
            bullet: '#ff0',
            alien: ['#0f0', '#f0f', '#ff0', '#0ff', '#f00'],
            powerUp: '#fff'
        };

        // ÂàùÊúüÂåñ
        function init() {
            resize();
            document.getElementById('highScore').textContent = highScore;

            // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
            document.getElementById('startBtn').addEventListener('click', startGame);
            document.getElementById('restartBtn').addEventListener('click', startGame);
            document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);

            canvas.addEventListener('click', shoot);
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                shoot(e.touches[0]);
            });

            window.addEventListener('resize', resize);
            window.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && gameRunning) {
                    e.preventDefault();
                    shootCenter();
                }
            });
        }

        function resize() {
            const rect = container.getBoundingClientRect();
            width = canvas.width = rect.width;
            height = canvas.height = rect.height;
            player.x = width / 2;
            player.y = height - 50;
        }

        function startGame() {
            gameRunning = true;
            score = 0;
            lives = 3;
            kills = 0;
            difficultyLevel = 1;
            alienSpawnRate = 60;

            bullets = [];
            aliens = [];
            particles = [];
            powerUps = [];

            updateUI();

            document.getElementById('startOverlay').classList.add('hidden');
            document.getElementById('gameOverOverlay').classList.add('hidden');

            gameLoop();
        }

        function gameLoop() {
            if (!gameRunning) return;

            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(0, 0, width, height);

            update();
            draw();

            requestAnimationFrame(gameLoop);
        }

        function update() {
            // Èõ£ÊòìÂ∫¶‰∏äÊòá
            if (score > difficultyLevel * 100) {
                difficultyLevel++;
                alienSpawnRate = Math.max(20, 60 - difficultyLevel * 5);
            }

            // „Ç®„Ç§„É™„Ç¢„É≥„Çπ„Éù„Éº„É≥
            alienSpawnTimer++;
            if (alienSpawnTimer >= alienSpawnRate) {
                spawnAlien();
                alienSpawnTimer = 0;
            }

            // Âºæ‰∏∏Êõ¥Êñ∞
            bullets = bullets.filter(b => {
                b.y -= b.speed;
                return b.y > -10;
            });

            // „Ç®„Ç§„É™„Ç¢„É≥Êõ¥Êñ∞
            aliens = aliens.filter(a => {
                a.y += a.speed;
                a.wobble = Math.sin(Date.now() * 0.01 + a.x) * 2;

                // ‰∏ã„Å´Âà∞ÈÅî
                if (a.y > height) {
                    lives--;
                    updateUI();
                    if (lives <= 0) {
                        gameOver();
                    }
                    return false;
                }
                return true;
            });

            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´Êõ¥Êñ∞
            particles = particles.filter(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                p.vy += 0.1;
                return p.life > 0;
            });

            // „Éë„ÉØ„Éº„Ç¢„ÉÉ„ÉóÊõ¥Êñ∞
            powerUps = powerUps.filter(p => {
                p.y += 2;
                return p.y < height;
            });

            // Ë°ùÁ™ÅÂà§ÂÆö
            checkCollisions();
        }

        function draw() {
            // „Éó„É¨„Ç§„É§„Éº
            ctx.fillStyle = colors.player;
            ctx.shadowBlur = 20;
            ctx.shadowColor = colors.player;
            drawTriangle(player.x, player.y, player.width, player.height);
            ctx.shadowBlur = 0;

            // Âºæ‰∏∏
            bullets.forEach(b => {
                ctx.fillStyle = colors.bullet;
                ctx.shadowBlur = 10;
                ctx.shadowColor = colors.bullet;
                ctx.beginPath();
                ctx.arc(b.x, b.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.shadowBlur = 0;

            // „Ç®„Ç§„É™„Ç¢„É≥
            aliens.forEach(a => {
                ctx.fillStyle = a.color;
                ctx.shadowBlur = 15;
                ctx.shadowColor = a.color;
                drawAlien(a.x + a.wobble, a.y, a.size);
            });
            ctx.shadowBlur = 0;

            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´
            particles.forEach(p => {
                ctx.fillStyle = `rgba(${p.r}, ${p.g}, ${p.b}, ${p.life / p.maxLife})`;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });

            // „Éë„ÉØ„Éº„Ç¢„ÉÉ„Éó
            powerUps.forEach(p => {
                ctx.fillStyle = colors.powerUp;
                ctx.shadowBlur = 15;
                ctx.shadowColor = colors.powerUp;
                ctx.font = `${p.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.fillText('‚≠ê', p.x, p.y);
            });
            ctx.shadowBlur = 0;
        }

        function drawTriangle(x, y, w, h) {
            ctx.beginPath();
            ctx.moveTo(x, y - h / 2);
            ctx.lineTo(x - w / 2, y + h / 2);
            ctx.lineTo(x + w / 2, y + h / 2);
            ctx.closePath();
            ctx.fill();
        }

        function drawAlien(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI * 2);
            ctx.fill();

            // ÁõÆ
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(x - size / 3, y - size / 4, size / 5, 0, Math.PI * 2);
            ctx.arc(x + size / 3, y - size / 4, size / 5, 0, Math.PI * 2);
            ctx.fill();
        }

        function shoot(e) {
            if (!gameRunning) return;

            const rect = canvas.getBoundingClientRect();
            let x, y;

            if (e.clientX) {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            } else {
                x = width / 2;
                y = height / 2;
            }

            bullets.push({
                x: player.x,
                y: player.y - player.height / 2,
                speed: 8,
                targetX: x,
                targetY: y
            });
        }

        function shootCenter() {
            if (!gameRunning) return;
            bullets.push({
                x: player.x,
                y: player.y - player.height / 2,
                speed: 8,
                targetX: width / 2,
                targetY: 0
            });
        }

        function spawnAlien() {
            const size = 15 + Math.random() * 15;
            aliens.push({
                x: Math.random() * (width - size * 2) + size,
                y: -size,
                size: size,
                speed: 1 + Math.random() * 2 + difficultyLevel * 0.3,
                color: colors.alien[Math.floor(Math.random() * colors.alien.length)],
                wobble: 0,
                points: Math.floor(100 - size) + difficultyLevel * 10
            });
        }

        function createExplosion(x, y, color) {
            for (let i = 0; i < 15; i++) {
                const angle = (Math.PI * 2 / 15) * i;
                const speed = 2 + Math.random() * 3;
                particles.push({
                    x: x,
                    y: y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    life: 30 + Math.random() * 20,
                    maxLife: 50,
                    size: 2 + Math.random() * 3,
                    r: parseInt(color.slice(1, 3), 16),
                    g: parseInt(color.slice(3, 5), 16),
                    b: parseInt(color.slice(5, 7), 16)
                });
            }
        }

        function checkCollisions() {
            bullets.forEach((b, bi) => {
                aliens.forEach((a, ai) => {
                    const dx = b.x - a.x;
                    const dy = b.y - a.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < a.size + 4) {
                        // „Éí„ÉÉ„Éà
                        createExplosion(a.x, a.y, a.color);
                        score += a.points;
                        kills++;

                        // „Éë„ÉØ„Éº„Ç¢„ÉÉ„Éó„Éâ„É≠„ÉÉ„Éó
                        if (Math.random() < 0.1) {
                            powerUps.push({
                                x: a.x,
                                y: a.y,
                                size: 20
                            });
                        }

                        bullets.splice(bi, 1);
                        aliens.splice(ai, 1);
                        updateUI();
                    }
                });
            });

            // „Éë„ÉØ„Éº„Ç¢„ÉÉ„ÉóË°ùÁ™Å
            powerUps.forEach((p, pi) => {
                const dx = player.x - p.x;
                const dy = player.y - p.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist < player.width) {
                    score += 50;
                    powerUps.splice(pi, 1);
                    updateUI();
                }
            });
        }

        function updateUI() {
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('livesDisplay').textContent = lives;
            document.getElementById('kills').textContent = kills;
        }

        function gameOver() {
            gameRunning = false;

            if (score > highScore) {
                highScore = score;
                localStorage.setItem('alienShooterHighScore', highScore);
                document.getElementById('highScore').textContent = highScore;
            }

            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOverOverlay').classList.remove('hidden');
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    console.log('ÂÖ®ÁîªÈù¢„Ç®„É©„Éº:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // ÂàùÊúüÂåñÂÆüË°å
        init();
    </script>
</body>
</html>

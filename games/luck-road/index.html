<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãã˜ã¸ã®é“ - Luck Road</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }
        
        #game {
            width: 100%;
            max-width: 600px;
            padding: 20px;
        }
        
        #header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        #header h1 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 5px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        #header p {
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }
        
        #stats {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }
        
        #board {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        #chests {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .chest {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .chest:hover:not(.opened) {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        .chest:active:not(.opened) {
            transform: scale(0.95);
        }
        
        .chest.opened {
            cursor: default;
            opacity: 0.6;
        }
        
        .chest-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .chest-reward {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        
        .chest.opened.jackpot {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            animation: jackpot 0.5s ease;
        }
        
        .chest.opened.good {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .chest.opened.neutral {
            background: linear-gradient(135deg, #a8a8a8 0%, #d4d4d4 100%);
        }
        
        .chest.opened.bad {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        @keyframes jackpot {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        #message {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        #message-text {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 10px;
        }
        
        #message-sub {
            font-size: 0.9rem;
            color: #666;
        }
        
        #controls {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.95);
            color: #667eea;
        }
        
        .btn-secondary:hover {
            background: #fff;
        }
        
        #fullscreenBtn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.3);
            border: 1px solid rgba(255,255,255,0.5);
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }
        
        #fullscreenBtn:hover {
            background: rgba(255,255,255,0.5);
        }
        
        .shake {
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @media (max-width: 768px) {
            #header h1 {
                font-size: 1.5rem;
            }
            #stats {
                grid-template-columns: repeat(3, 1fr);
                padding: 10px;
            }
            .stat-value {
                font-size: 1.2rem;
            }
            #chests {
                gap: 10px;
            }
            .chest-icon {
                font-size: 2rem;
            }
            .chest-reward {
                font-size: 1.2rem;
            }
            #fullscreenBtn {
                padding: 8px 12px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <button id="fullscreenBtn">å…¨ç”»é¢</button>
    
    <div id="game">
        <div id="header">
            <h1>ğŸ° ãã˜ã¸ã®é“</h1>
            <p>Luck Road - é‹è©¦ã—ã‚²ãƒ¼ãƒ </p>
        </div>
        
        <div id="stats">
            <div class="stat">
                <div class="stat-label">ç¾åœ¨ã‚¹ã‚³ã‚¢</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">é€£å‹</div>
                <div class="stat-value" id="streak">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">æœ€é«˜è¨˜éŒ²</div>
                <div class="stat-value" id="best">0</div>
            </div>
        </div>
        
        <div id="board">
            <div id="chests"></div>
        </div>
        
        <div id="message">
            <div id="message-text">å®ç®±ã‚’é¸ã‚“ã§é‹è©¦ã—ï¼</div>
            <div id="message-sub">9å€‹ã®å®ç®±ã‹ã‚‰1ã¤ã‚’é¸ã‚“ã§ãã ã•ã„</div>
        </div>
        
        <div id="controls">
            <button class="btn btn-primary" id="newGameBtn">æ–°ã—ã„ã‚²ãƒ¼ãƒ </button>
            <button class="btn btn-secondary" id="autoBtn">ã‚ªãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤</button>
        </div>
    </div>
    
    <script>
        const gameState = {
            score: 0,
            streak: 0,
            best: parseInt(localStorage.getItem('luckRoadBest')) || 0,
            chests: [],
            opened: 0,
            autoPlaying: false
        };
        
        // å ±é…¬ã®å®šç¾©
        const rewards = {
            jackpot: { 
                min: 100, 
                max: 500, 
                icon: 'ğŸ’', 
                message: 'ã‚¸ãƒ£ãƒƒã‚¯ãƒãƒƒãƒˆï¼', 
                sub: 'ãƒ©ãƒƒã‚­ãƒ¼ï¼',
                class: 'jackpot',
                probability: 0.05
            },
            good: { 
                min: 20, 
                max: 80, 
                icon: 'â­', 
                message: 'å¤§å½“ãŸã‚Šï¼', 
                sub: 'ãƒŠã‚¤ã‚¹ï¼',
                class: 'good',
                probability: 0.2
            },
            neutral: { 
                min: 5, 
                max: 15, 
                icon: 'ğŸª™', 
                message: 'å°å½“ãŸã‚Š', 
                sub: 'ã¾ã‚ã¾ã‚',
                class: 'neutral',
                probability: 0.5
            },
            bad: { 
                min: -50, 
                max: -10, 
                icon: 'ğŸ’¨', 
                message: 'ãƒã‚ºãƒ¬...', 
                sub: 'æ¬¡ã¯ã‚ã‚‹ï¼',
                class: 'bad',
                probability: 0.25
            }
        };
        
        function getRandomReward() {
            const rand = Math.random();
            let reward;
            
            if (rand < rewards.jackpot.probability) {
                reward = rewards.jackpot;
            } else if (rand < rewards.jackpot.probability + rewards.good.probability) {
                reward = rewards.good;
            } else if (rand < rewards.jackpot.probability + rewards.good.probability + rewards.neutral.probability) {
                reward = rewards.neutral;
            } else {
                reward = rewards.bad;
            }
            
            const amount = Math.floor(Math.random() * (reward.max - reward.min + 1)) + reward.min;
            return { ...reward, amount };
        }
        
        function initChests() {
            gameState.chests = [];
            gameState.opened = 0;
            
            for (let i = 0; i < 9; i++) {
                gameState.chests.push({
                    id: i,
                    opened: false,
                    reward: getRandomReward()
                });
            }
        }
        
        function renderChests() {
            const container = document.getElementById('chests');
            container.innerHTML = '';
            
            gameState.chests.forEach(chest => {
                const div = document.createElement('div');
                div.className = 'chest' + (chest.opened ? ' opened ' + chest.reward.class : '');
                div.id = `chest-${chest.id}`;
                
                if (!chest.opened) {
                    div.innerHTML = `<div class="chest-icon">ğŸ“¦</div>`;
                    div.addEventListener('click', () => openChest(chest.id));
                    div.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        openChest(chest.id);
                    });
                } else {
                    div.innerHTML = `
                        <div class="chest-icon">${chest.reward.icon}</div>
                        <div class="chest-reward">${chest.reward.amount > 0 ? '+' : ''}${chest.reward.amount}</div>
                    `;
                }
                
                container.appendChild(div);
            });
        }
        
        function openChest(id) {
            const chest = gameState.chests[id];
            if (chest.opened || gameState.autoPlaying) return;
            
            chest.opened = true;
            gameState.opened++;
            
            // ã‚¹ã‚³ã‚¢æ›´æ–°
            gameState.score += chest.reward.amount;
            if (chest.reward.amount > 0) {
                gameState.streak++;
            } else {
                gameState.streak = 0;
            }
            
            if (gameState.score > gameState.best) {
                gameState.best = gameState.score;
                localStorage.setItem('luckRoadBest', gameState.best);
            }
            
            // UIæ›´æ–°
            renderChests();
            updateStats();
            showMessage(chest.reward.message, chest.reward.sub);
            
            // ã‚¸ãƒ£ãƒƒã‚¯ãƒãƒƒãƒˆã®å ´åˆã¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            if (chest.reward.class === 'jackpot') {
                document.getElementById('score').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('score').classList.remove('shake');
                }, 500);
            }
            
            // å…¨ã¦é–‹ã‘ãŸã‹ãƒã‚§ãƒƒã‚¯
            if (gameState.opened === 9) {
                setTimeout(() => {
                    showMessage(
                        'ãƒ©ã‚¦ãƒ³ãƒ‰çµ‚äº†ï¼',
                        `æœ€çµ‚ã‚¹ã‚³ã‚¢: ${gameState.score} | é€£å‹: ${gameState.streak}`
                    );
                }, 500);
            }
        }
        
        function updateStats() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('streak').textContent = gameState.streak;
            document.getElementById('best').textContent = gameState.best;
        }
        
        function showMessage(text, sub) {
            document.getElementById('message-text').textContent = text;
            document.getElementById('message-sub').textContent = sub;
        }
        
        function newGame() {
            initChests();
            renderChests();
            showMessage('å®ç®±ã‚’é¸ã‚“ã§é‹è©¦ã—ï¼', '9å€‹ã®å®ç®±ã‹ã‚‰1ã¤ã‚’é¸ã‚“ã§ãã ã•ã„');
        }
        
        async function autoPlay() {
            if (gameState.autoPlaying) return;
            
            gameState.autoPlaying = true;
            document.getElementById('autoBtn').textContent = 'ãƒ—ãƒ¬ã‚¤ä¸­...';
            document.getElementById('autoBtn').disabled = true;
            
            // å…¨ã¦ã®å®ç®±ã‚’è‡ªå‹•ã§é–‹ã‘ã‚‹
            for (let i = 0; i < 9; i++) {
                if (!gameState.chests[i].opened) {
                    openChest(i);
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
            }
            
            // æ–°ã—ã„ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’é–‹å§‹
            await new Promise(resolve => setTimeout(resolve, 1000));
            newGame();
            
            gameState.autoPlaying = false;
            document.getElementById('autoBtn').textContent = 'ã‚ªãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤';
            document.getElementById('autoBtn').disabled = false;
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('newGameBtn').addEventListener('click', newGame);
        document.getElementById('autoBtn').addEventListener('click', autoPlay);
        
        // å…¨ç”»é¢ãƒœã‚¿ãƒ³
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                fullscreenBtn.textContent = 'å…ƒã«æˆ»ã™';
            } else {
                document.exitFullscreen();
                fullscreenBtn.textContent = 'å…¨ç”»é¢';
            }
        });
        
        // åˆæœŸåŒ–
        initChests();
        renderChests();
        updateStats();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Memory - „Çπ„Éî„Éº„ÉâË®òÊÜ∂„Ç≤„Éº„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            max-width: 600px;
            width: 100%;
        }

        h1 {
            color: #ffffff;
            text-align: center;
            font-size: clamp(24px, 6vw, 36px);
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(100, 200, 255, 0.5);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            color: #ffffff;
            font-size: clamp(14px, 3.5vw, 18px);
        }

        .stat {
            text-align: center;
            padding: 10px 20px;
            background: rgba(100, 200, 255, 0.2);
            border-radius: 10px;
            border: 2px solid rgba(100, 200, 255, 0.4);
        }

        .stat-value {
            font-size: clamp(20px, 5vw, 28px);
            font-weight: bold;
            color: #64c8ff;
        }

        .game-area {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .card {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #2a2a4e, #1a1a3e);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(32px, 8vw, 48px);
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid rgba(100, 200, 255, 0.3);
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .card:hover:not(.flipped) {
            transform: scale(1.05);
            border-color: rgba(100, 200, 255, 0.6);
            box-shadow: 0 5px 20px rgba(100, 200, 255, 0.4);
        }

        .card.flipped {
            background: linear-gradient(145deg, #64c8ff, #4a9fd9);
            color: #1a1a2e;
            border-color: #64c8ff;
        }

        .card.correct {
            background: linear-gradient(145deg, #4ade80, #22c55e);
            border-color: #4ade80;
            animation: correctPulse 0.5s;
        }

        .card.wrong {
            background: linear-gradient(145deg, #f87171, #ef4444);
            border-color: #f87171;
            animation: wrongPulse 0.5s;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongPulse {
            0%, 100% { transform: scale(1); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .card.hidden {
            background: rgba(100, 200, 255, 0.1);
            border-color: rgba(100, 200, 255, 0.2);
            cursor: default;
        }

        .card.hidden::after {
            content: '‚úì';
            font-size: clamp(24px, 6vw, 36px);
            color: rgba(100, 200, 255, 0.5);
        }

        .start-screen, .game-over-screen {
            text-align: center;
            color: #ffffff;
            padding: 40px 20px;
        }

        .start-screen h2, .game-over-screen h2 {
            font-size: clamp(20px, 5vw, 28px);
            margin-bottom: 20px;
        }

        .btn {
            background: linear-gradient(145deg, #64c8ff, #4a9fd9);
            color: #1a1a2e;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: clamp(14px, 3.5vw, 18px);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin: 10px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(100, 200, 255, 0.6);
        }

        .instructions {
            background: rgba(100, 200, 255, 0.1);
            border: 2px solid rgba(100, 200, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            color: #ffffff;
            font-size: clamp(12px, 3vw, 14px);
            line-height: 1.6;
        }

        .timer-bar {
            width: 100%;
            height: 8px;
            background: rgba(100, 200, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .timer-progress {
            height: 100%;
            background: linear-gradient(90deg, #64c8ff, #4ade80);
            transition: width 0.1s linear;
        }

        .difficulty {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .difficulty-btn {
            background: rgba(100, 200, 255, 0.2);
            border: 2px solid rgba(100, 200, 255, 0.4);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: clamp(12px, 3vw, 14px);
            transition: all 0.3s;
        }

        .difficulty-btn:hover {
            background: rgba(100, 200, 255, 0.4);
        }

        .difficulty-btn.active {
            background: rgba(100, 200, 255, 0.6);
            border-color: rgba(150, 200, 255, 0.8);
        }

        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(100, 200, 255, 0.2);
            border: 2px solid rgba(100, 200, 255, 0.5);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: clamp(12px, 3vw, 14px);
            transition: all 0.3s;
            z-index: 1000;
        }

        .fullscreen-btn:hover {
            background: rgba(100, 200, 255, 0.4);
            transform: scale(1.05);
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 20px;
            }

            .game-area {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" id="fullscreenBtn">ÂÖ®ÁîªÈù¢</button>

    <div class="game-container">
        <h1>üéØ Speed Memory</h1>

        <div id="startScreen" class="start-screen">
            <h2>„Çπ„Éî„Éº„ÉâË®òÊÜ∂„Ç≤„Éº„É†</h2>

            <div class="instructions">
                <p>üéÆ <strong>ÈÅä„Å≥Êñπ</strong></p>
                <p>1. „Ç´„Éº„Éâ„Å´Ë°®Á§∫„Åï„Çå„ÇãÊï∞Â≠ó„ÇíË¶ö„Åà„Çã</p>
                <p>2. „Ç´„Éº„Éâ„ÅåË£èËøî„Çã</p>
                <p>3. ÊòáÈ†Ü„Å´„Çø„ÉÉ„Éó„Åó„Å¶„ÅÑ„Åè</p>
                <p>4. ÊôÇÈñìÂÜÖ„Å´ÂÖ®„Å¶Ê≠£Ëß£ÔºÅ</p>
            </div>

            <p style="margin-bottom: 10px; color: #64c8ff;">Èõ£ÊòìÂ∫¶„ÇíÈÅ∏Êäû</p>
            <div class="difficulty">
                <button class="difficulty-btn active" data-difficulty="easy">Á∞°Âçò</button>
                <button class="difficulty-btn" data-difficulty="medium">ÊôÆÈÄö</button>
                <button class="difficulty-btn" data-difficulty="hard">Èõ£„Åó„ÅÑ</button>
            </div>

            <button class="btn" id="startBtn">„Çπ„Çø„Éº„Éà</button>
        </div>

        <div id="gameArea" style="display: none;">
            <div class="stats">
                <div class="stat">
                    <div>„Çπ„Ç≥„Ç¢</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat">
                    <div>„É¨„Éô„É´</div>
                    <div class="stat-value" id="level">1</div>
                </div>
                <div class="stat">
                    <div>Ê¨°</div>
                    <div class="stat-value" id="nextNumber">-</div>
                </div>
            </div>

            <div class="timer-bar">
                <div class="timer-progress" id="timerProgress"></div>
            </div>

            <div class="game-area" id="gameGrid"></div>
        </div>

        <div id="gameOverScreen" class="game-over-screen" style="display: none;">
            <h2>„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº</h2>
            <p style="font-size: clamp(18px, 4.5vw, 24px); margin: 20px 0;">
                ÊúÄÁµÇ„Çπ„Ç≥„Ç¢: <span style="color: #64c8ff; font-weight: bold;" id="finalScore">0</span>
            </p>
            <p style="font-size: clamp(14px, 3.5vw, 18px); margin-bottom: 20px;">
                Âà∞ÈÅî„É¨„Éô„É´: <span style="color: #4ade80;" id="finalLevel">1</span>
            </p>
            <button class="btn" id="restartBtn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶</button>
        </div>
    </div>

    <script>
        const startScreen = document.getElementById('startScreen');
        const gameArea = document.getElementById('gameArea');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const gameGrid = document.getElementById('gameGrid');
        const scoreEl = document.getElementById('score');
        const levelEl = document.getElementById('level');
        const nextNumberEl = document.getElementById('nextNumber');
        const finalScoreEl = document.getElementById('finalScore');
        const finalLevelEl = document.getElementById('finalLevel');
        const timerProgress = document.getElementById('timerProgress');

        let score = 0;
        let level = 1;
        let cards = [];
        let nextNumber = 1;
        let gameActive = false;
        let timerInterval = null;
        let timeLeft = 0;
        let maxTime = 0;
        let difficulty = 'easy';

        const difficultySettings = {
            easy: { cardCount: 3, showTime: 3000, gameTime: 5000 },
            medium: { cardCount: 4, showTime: 2000, gameTime: 4000 },
            hard: { cardCount: 5, showTime: 1500, gameTime: 3000 }
        };

        // Èõ£ÊòìÂ∫¶„Éú„Çø„É≥
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                difficulty = btn.dataset.difficulty;
            });
        });

        // „Ç≤„Éº„É†ÈñãÂßã
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('restartBtn').addEventListener('click', startGame);

        function startGame() {
            score = 0;
            level = 1;
            updateStats();

            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            gameArea.style.display = 'block';

            startLevel();
        }

        function startLevel() {
            const settings = difficultySettings[difficulty];
            const cardCount = Math.min(settings.cardCount + Math.floor(level / 3), 9);

            // „Ç´„Éº„Éâ„ÇíÁîüÊàê
            cards = [];
            for (let i = 1; i <= cardCount; i++) {
                cards.push({
                    number: i,
                    id: i
                });
            }

            // „Ç∑„É£„ÉÉ„Éï„É´
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }

            nextNumber = 1;
            nextNumberEl.textContent = nextNumber;

            // „Ç∞„É™„ÉÉ„Éâ„ÇíÊèèÁîª
            renderGrid(true);

            // Êï∞Â≠ó„ÇíË°®Á§∫
            setTimeout(() => {
                renderGrid(false);
                startTimer(settings.gameTime);
            }, settings.showTime);
        }

        function renderGrid(showNumbers) {
            gameGrid.innerHTML = '';
            gameGrid.style.gridTemplateColumns = `repeat(${Math.ceil(Math.sqrt(cards.length))}, 1fr)`;

            cards.forEach((card, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = 'card';
                cardEl.dataset.id = card.id;

                if (showNumbers) {
                    cardEl.classList.add('flipped');
                    cardEl.textContent = card.number;
                }

                cardEl.addEventListener('click', () => handleCardClick(card.id, cardEl));
                gameGrid.appendChild(cardEl);
            });
        }

        function handleCardClick(id, cardEl) {
            if (!gameActive) return;
            if (cardEl.classList.contains('hidden')) return;

            if (id === nextNumber) {
                // Ê≠£Ëß£
                cardEl.classList.add('correct');
                cardEl.classList.add('flipped');
                cardEl.textContent = id;

                setTimeout(() => {
                    cardEl.classList.add('hidden');
                    cardEl.textContent = '';

                    if (nextNumber >= cards.length) {
                        // „É¨„Éô„É´„ÇØ„É™„Ç¢
                        levelComplete();
                    } else {
                        nextNumber++;
                        nextNumberEl.textContent = nextNumber;
                    }
                }, 300);
            } else {
                // ‰∏çÊ≠£Ëß£
                cardEl.classList.add('wrong');
                cardEl.classList.add('flipped');
                cardEl.textContent = id;

                setTimeout(() => {
                    gameOver();
                }, 500);
            }
        }

        function startTimer(timeMs) {
            maxTime = timeMs;
            timeLeft = timeMs;
            gameActive = true;

            updateTimer();

            timerInterval = setInterval(() => {
                timeLeft -= 100;
                updateTimer();

                if (timeLeft <= 0) {
                    gameOver();
                }
            }, 100);
        }

        function updateTimer() {
            const progress = (timeLeft / maxTime) * 100;
            timerProgress.style.width = progress + '%';
        }

        function levelComplete() {
            gameActive = false;
            clearInterval(timerInterval);

            score += level * 10;
            level++;
            updateStats();

            setTimeout(() => {
                startLevel();
            }, 1000);
        }

        function gameOver() {
            gameActive = false;
            clearInterval(timerInterval);

            finalScoreEl.textContent = score;
            finalLevelEl.textContent = level;

            gameArea.style.display = 'none';
            gameOverScreen.style.display = 'block';
        }

        function updateStats() {
            scoreEl.textContent = score;
            levelEl.textContent = level;
        }

        // ÂÖ®ÁîªÈù¢„Éú„Çø„É≥
        document.getElementById('fullscreenBtn').addEventListener('click', () => {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                document.documentElement.requestFullscreen();
            }
        });

        // „Çø„ÉÉ„ÉÅÊìç‰Ωú„ÅÆÈò≤Ê≠¢
        document.addEventListener('touchmove', (e) => {
            if (gameActive) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>

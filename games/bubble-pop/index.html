<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Pop | Ê≥°Ââ≤„Çä„Ç≤„Éº„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            padding: 20px;
        }

        h1 {
            color: #ffffff;
            font-size: clamp(1.5rem, 5vw, 3rem);
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            text-align: center;
        }

        .stats {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 15px;
            color: white;
            font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-weight: bold;
            font-size: 1.5rem;
            margin-left: 10px;
        }

        .game-container {
            position: relative;
            width: min(90vw, 600px);
            height: min(60vh, 400px);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .bubble {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.9), rgba(200, 200, 255, 0.3));
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.5),
                        0 0 20px rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: transform 0.1s;
            animation: float 3s ease-in-out infinite;
        }

        .bubble:hover {
            transform: scale(1.1);
        }

        .bubble:active {
            transform: scale(0.95);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .pop-effect {
            position: absolute;
            pointer-events: none;
            animation: pop 0.3s ease-out forwards;
        }

        @keyframes pop {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.6);
        }

        .fullscreen-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .fullscreen-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .hint {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-top: 15px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .stats {
                gap: 15px;
            }

            .stat {
                padding: 8px 15px;
                font-size: 0.9rem;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <h1>ü´ß Bubble Pop</h1>

    <div class="stats">
        <div class="stat">
            „Çπ„Ç≥„Ç¢<span class="stat-value" id="score">0</span>
        </div>
        <div class="stat">
            Ê≥°„ÅÆÊï∞<span class="stat-value" id="bubbleCount">0</span>
        </div>
    </div>

    <div class="game-container" id="gameContainer">
        <button class="fullscreen-btn" id="fullscreenBtn" title="ÂÖ®ÁîªÈù¢Ë°®Á§∫">‚õ∂</button>
    </div>

    <div class="controls">
        <button id="addBtn">Ê≥°„ÇíËøΩÂä†</button>
        <button id="clearBtn">ÂÖ®„Å¶Ê∂à„Åô</button>
    </div>

    <p class="hint">üí° Ê≥°„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Ââ≤„Çç„ÅÜÔºÅ„Çø„Ç§„Éü„É≥„Ç∞„Çà„ÅèÈÄ£Á∂ö„ÅßÂâ≤„Çã„Å®„Éè„Ç§„ÉÜ„É≥„Ç∑„Éß„É≥</p>

    <script>
        const gameContainer = document.getElementById('gameContainer');
        const scoreEl = document.getElementById('score');
        const bubbleCountEl = document.getElementById('bubbleCount');
        const addBtn = document.getElementById('addBtn');
        const clearBtn = document.getElementById('clearBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');

        let score = 0;
        let bubbles = [];
        let combo = 0;
        let lastPopTime = 0;

        // Ê≥°„Çí‰ΩúÊàê
        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';

            const size = Math.random() * 40 + 40; // 40-80px
            const x = Math.random() * (gameContainer.offsetWidth - size);
            const y = Math.random() * (gameContainer.offsetHeight - size);

            bubble.style.width = size + 'px';
            bubble.style.height = size + 'px';
            bubble.style.left = x + 'px';
            bubble.style.top = y + 'px';
            bubble.style.animationDelay = Math.random() * 2 + 's';

            // „ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
            bubble.addEventListener('click', (e) => {
                e.stopPropagation();
                popBubble(bubble);
            });

            gameContainer.appendChild(bubble);
            bubbles.push(bubble);
            updateBubbleCount();
        }

        // Ê≥°„ÇíÂâ≤„Çã
        function popBubble(bubble) {
            const now = Date.now();

            // „Ç≥„É≥„ÉúÂà§ÂÆö
            if (now - lastPopTime < 500) {
                combo++;
            } else {
                combo = 1;
            }
            lastPopTime = now;

            // „Çπ„Ç≥„Ç¢Ë®àÁÆóÔºà„Ç≥„É≥„Éú„Éú„Éº„Éä„ÇπÔºâ
            const points = 10 * combo;
            score += points;
            updateScore();

            // „Éù„ÉÉ„Éó„Ç®„Éï„Çß„ÇØ„Éà
            createPopEffect(bubble);

            // Ê≥°„ÇíÂâäÈô§
            const index = bubbles.indexOf(bubble);
            if (index > -1) {
                bubbles.splice(index, 1);
            }
            bubble.remove();
            updateBubbleCount();

            // Èü≥„ÇíÂÜçÁîü
            playPopSound();
        }

        // „Éù„ÉÉ„Éó„Ç®„Éï„Çß„ÇØ„Éà„Çí‰ΩúÊàê
        function createPopEffect(bubble) {
            const effect = document.createElement('div');
            effect.className = 'pop-effect';
            effect.style.width = bubble.offsetWidth + 'px';
            effect.style.height = bubble.offsetHeight + 'px';
            effect.style.left = bubble.style.left;
            effect.style.top = bubble.style.top;
            effect.style.background = bubble.style.background;
            effect.style.borderRadius = '50%';

            gameContainer.appendChild(effect);

            setTimeout(() => {
                effect.remove();
            }, 300);
        }

        // Èü≥„ÇíÂÜçÁîü
        function playPopSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // „Ç≥„É≥„Éú„Å´Âøú„Åò„Å¶Èü≥Á®ã„ÇíÂ§âÂåñ
            const baseFreq = 400 + (combo * 50);
            oscillator.frequency.setValueAtTime(baseFreq, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(baseFreq * 1.5, audioContext.currentTime + 0.1);

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        // „Çπ„Ç≥„Ç¢Êõ¥Êñ∞
        function updateScore() {
            scoreEl.textContent = score;
        }

        // Ê≥°„ÅÆÊï∞Êõ¥Êñ∞
        function updateBubbleCount() {
            bubbleCountEl.textContent = bubbles.length;
        }

        // ÂÖ®ÁîªÈù¢Ë°®Á§∫
        fullscreenBtn.addEventListener('click', () => {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                gameContainer.requestFullscreen();
            }
        });

        // Ê≥°„ÇíËøΩÂä†„Éú„Çø„É≥
        addBtn.addEventListener('click', () => {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => createBubble(), i * 50);
            }
        });

        // ÂÖ®„Å¶Ê∂à„Åô„Éú„Çø„É≥
        clearBtn.addEventListener('click', () => {
            bubbles.forEach(bubble => bubble.remove());
            bubbles = [];
            updateBubbleCount();
            score = 0;
            combo = 0;
            updateScore();
        });

        // ÂàùÊúüÊ≥°„ÇíÁîüÊàê
        for (let i = 0; i < 10; i++) {
            setTimeout(() => createBubble(), i * 100);
        }

        // ÂÆöÊúüÁöÑ„Å´Ê≥°„ÇíËøΩÂä†
        setInterval(() => {
            if (bubbles.length < 20) {
                createBubble();
            }
        }, 2000);
    </script>
</body>
</html>

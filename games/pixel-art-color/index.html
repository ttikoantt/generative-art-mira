<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® Pixel Art Color by Number</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 5px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
        }

        .stat-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 3px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .palette {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .color-btn {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .color-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .color-btn.selected {
            border-color: #fff;
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .color-btn.completed {
            opacity: 0.5;
        }

        .grid-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            gap: 2px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
        }

        .cell {
            width: 28px;
            height: 28px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            user-select: none;
        }

        .cell:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .cell.empty {
            background: rgba(255, 255, 255, 0.05) !important;
            cursor: default;
        }

        .cell.colored {
            color: transparent;
            text-shadow: none;
        }

        .cell.hint {
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
            }
            50% {
                box-shadow: 0 0 0 8px rgba(255, 255, 255, 0);
            }
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #fff;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .completion-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .completion-modal.show {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            max-width: 90%;
        }

        .modal-content h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .modal-content p {
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.9);
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5rem;
            }

            .color-btn {
                width: 38px;
                height: 38px;
                font-size: 0.8rem;
            }

            .cell {
                width: 24px;
                height: 24px;
                font-size: 0.6rem;
            }

            .btn {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé® Pixel Art Color by Number</h1>
        <p class="subtitle">Êï∞Â≠ó„Å´Âêà„Çè„Åõ„Å¶Ëâ≤„ÇíÂ°ó„Çç„ÅÜÔºÅ</p>
    </div>

    <div class="game-container">
        <div class="stats">
            <div class="stat">
                <div class="stat-label">ÈÄ≤Êçó</div>
                <div class="stat-value" id="progress">0%</div>
            </div>
            <div class="stat">
                <div class="stat-label">ÊôÇÈñì</div>
                <div class="stat-value" id="timer">0:00</div>
            </div>
            <div class="stat">
                <div class="stat-label">‰ΩúÂìÅ</div>
                <div class="stat-value" id="artwork">1/5</div>
            </div>
        </div>

        <div class="palette" id="palette"></div>

        <div class="grid-container">
            <div class="grid" id="grid"></div>
        </div>

        <div class="buttons">
            <button class="btn btn-secondary" onclick="showHint()">üí° „Éí„É≥„Éà</button>
            <button class="btn btn-primary" onclick="nextArtwork()">Ê¨°„ÅÆ‰ΩúÂìÅ ‚Üí</button>
        </div>
    </div>

    <div class="completion-modal" id="completionModal">
        <div class="modal-content">
            <h2>üéâ ÂÆåÊàê„Åä„ÇÅ„Åß„Å®„ÅÜÔºÅ</h2>
            <p id="completionText">Á¥†Êô¥„Çâ„Åó„ÅÑ‰ΩúÂìÅ„Åå„Åß„Åç„Åæ„Åó„ÅüÔºÅ</p>
            <button class="btn btn-primary" onclick="closeModal(); nextArtwork();">Ê¨°„ÅÆ‰ΩúÂìÅ ‚Üí</button>
        </div>
    </div>

    <script>
        // Pixel art patterns
        const patterns = [
            {
                name: "„Éè„Éº„Éà",
                grid: [
                    [0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,1,1,0,0,0,1,1,0,0],
                    [0,1,1,1,1,0,1,1,1,1,0],
                    [0,1,1,1,1,1,1,1,1,1,0],
                    [0,1,1,1,1,1,1,1,1,1,0],
                    [0,0,1,1,1,1,1,1,1,0,0],
                    [0,0,0,1,1,1,1,1,0,0,0],
                    [0,0,0,0,1,1,1,0,0,0,0],
                    [0,0,0,0,0,1,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0]
                ],
                colors: {
                    1: { color: "#ff6b9d", name: "„Éî„É≥„ÇØ" }
                }
            },
            {
                name: "„Çπ„Çø„Éº",
                grid: [
                    [0,0,0,0,0,1,0,0,0,0,0],
                    [0,0,0,0,1,1,1,0,0,0,0],
                    [0,0,0,1,1,1,1,1,0,0,0],
                    [1,1,1,1,1,1,1,1,1,1,1],
                    [0,1,1,1,1,1,1,1,1,1,0],
                    [0,0,1,1,1,2,1,1,1,0,0],
                    [0,0,0,1,1,1,1,1,0,0,0],
                    [0,0,1,1,1,0,1,1,1,0,0],
                    [0,1,1,1,0,0,0,1,1,1,0],
                    [0,1,1,0,0,0,0,0,1,1,0],
                    [0,0,0,0,0,0,0,0,0,0,0]
                ],
                colors: {
                    1: { color: "#ffd93d", name: "ÈªÑËâ≤" },
                    2: { color: "#ff9500", name: "„Ç™„É¨„É≥„Ç∏" }
                }
            },
            {
                name: "Ëä±",
                grid: [
                    [0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,1,0,0,0,1,0,0,0],
                    [0,0,1,2,1,0,1,2,1,0,0],
                    [0,1,2,2,2,1,2,2,2,1,0],
                    [0,0,1,2,2,2,2,2,1,0,0],
                    [0,0,0,1,2,2,2,1,0,0,0],
                    [0,0,0,0,1,2,1,0,0,0,0],
                    [0,0,0,0,0,3,0,0,0,0,0],
                    [0,0,0,0,0,3,0,0,0,0,0],
                    [0,0,0,0,0,3,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0]
                ],
                colors: {
                    1: { color: "#ff6b9d", name: "„Éî„É≥„ÇØ" },
                    2: { color: "#ff9500", name: "„Ç™„É¨„É≥„Ç∏" },
                    3: { color: "#4cd964", name: "Á∑ë" }
                }
            },
            {
                name: "Áå´",
                grid: [
                    [0,0,0,0,1,0,1,0,0,0,0],
                    [0,0,0,1,1,1,1,1,0,0,0],
                    [0,0,1,1,1,1,1,1,1,0,0],
                    [0,0,1,2,2,2,2,2,1,0,0],
                    [0,0,1,2,3,4,3,2,1,0,0],
                    [0,0,1,2,2,2,2,2,1,0,0],
                    [0,0,1,1,5,5,5,1,1,0,0],
                    [0,0,0,1,5,5,5,1,0,0,0],
                    [0,0,0,0,1,1,1,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0]
                ],
                colors: {
                    1: { color: "#8b8b8b", name: "„Ç∞„É¨„Éº" },
                    2: { color: "#d4d4d4", name: "„É©„Ç§„Éà„Ç∞„É¨„Éº" },
                    3: { color: "#5ac8fa", name: "Ê∞¥Ëâ≤" },
                    4: { color: "#000000", name: "Èªí" },
                    5: { color: "#ff9500", name: "„Ç™„É¨„É≥„Ç∏" }
                }
            },
            {
                name: "„Éû„É≥„Ç∑„Éß„É≥",
                grid: [
                    [1,1,1,1,1,1,1,1,1,1,1],
                    [1,2,2,2,2,2,2,2,2,2,1],
                    [1,2,2,2,2,2,2,2,2,2,1],
                    [1,2,3,3,3,2,3,3,3,2,1],
                    [1,2,3,3,3,2,3,3,3,2,1],
                    [1,2,3,3,3,2,3,3,3,2,1],
                    [1,2,2,2,2,2,2,2,2,2,1],
                    [1,2,3,3,2,2,2,3,3,2,1],
                    [1,2,3,3,2,2,2,3,3,2,1],
                    [1,2,2,2,2,2,2,2,2,2,1],
                    [1,1,1,1,1,1,1,1,1,1,1]
                ],
                colors: {
                    1: { color: "#8e8e93", name: "„Ç∞„É¨„Éº" },
                    2: { color: "#007aff", name: "„Éñ„É´„Éº" },
                    3: { color: "#ffcc00", name: "„Ç§„Ç®„É≠„Éº" }
                }
            }
        ];

        let currentPattern = 0;
        let selectedColor = null;
        let startTime = null;
        let timerInterval = null;
        let coloredCells = 0;
        let totalCells = 0;

        function init() {
            loadPattern(currentPattern);
            startTimer();
        }

        function loadPattern(index) {
            const pattern = patterns[index];
            const palette = document.getElementById('palette');
            const grid = document.getElementById('grid');
            const artworkDisplay = document.getElementById('artwork');

            palette.innerHTML = '';
            grid.innerHTML = '';

            // Update artwork counter
            artworkDisplay.textContent = `${index + 1}/${patterns.length}`;

            // Reset state
            coloredCells = 0;
            totalCells = 0;
            selectedColor = null;
            updateProgress();

            // Create palette
            Object.entries(pattern.colors).forEach(([num, colorData]) => {
                const btn = document.createElement('div');
                btn.className = 'color-btn';
                btn.style.backgroundColor = colorData.color;
                btn.textContent = num;
                btn.onclick = () => selectColor(num, colorData.color, btn);
                palette.appendChild(btn);
            });

            // Create grid
            const gridWidth = pattern.grid[0].length;
            grid.style.gridTemplateColumns = `repeat(${gridWidth}, 1fr)`;

            pattern.grid.forEach((row, y) => {
                row.forEach((cell, x) => {
                    const div = document.createElement('div');
                    div.className = 'cell';
                    div.dataset.x = x;
                    div.dataset.y = y;
                    div.dataset.color = cell;

                    if (cell === 0) {
                        div.classList.add('empty');
                    } else {
                        div.textContent = cell;
                        totalCells++;
                        div.onclick = () => colorCell(div, cell);
                    }

                    grid.appendChild(div);
                });
            });

            // Reset timer
            startTime = Date.now();
        }

        function selectColor(num, color, btn) {
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedColor = num;
        }

        function colorCell(cell, colorNum) {
            if (cell.classList.contains('colored') || cell.classList.contains('empty')) return;

            if (selectedColor === null) {
                // If no color selected, use the cell's number
                const pattern = patterns[currentPattern];
                const colorData = pattern.colors[colorNum];
                colorCellDirect(cell, colorData.color);
            } else if (selectedColor === colorNum) {
                // Correct color
                colorCellDirect(cell, patterns[currentPattern].colors[colorNum].color);
            } else {
                // Wrong color - shake effect
                cell.style.animation = 'none';
                cell.offsetHeight;
                cell.style.animation = 'shake 0.3s ease';
            }
        }

        function colorCellDirect(cell, color) {
            cell.classList.add('colored');
            cell.style.backgroundColor = color;
            coloredCells++;
            updateProgress();
            checkCompletion();
        }

        function updateProgress() {
            const progress = totalCells > 0 ? Math.round((coloredCells / totalCells) * 100) : 0;
            document.getElementById('progress').textContent = progress + '%';
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            startTime = Date.now();

            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timer').textContent =
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function showHint() {
            const cells = document.querySelectorAll('.cell:not(.colored):not(.empty)');
            if (cells.length === 0) return;

            // Find all cells of the same color
            const pattern = patterns[currentPattern];
            const uncoloredNumbers = Array.from(cells).map(c => parseInt(c.dataset.color));
            const mostCommon = uncoloredNumbers.sort((a, b) =>
                uncoloredNumbers.filter(v => v === b).length - uncoloredNumbers.filter(v => v === a).length
            )[0];

            // Highlight cells with the most common color
            cells.forEach(cell => {
                if (parseInt(cell.dataset.color) === mostCommon) {
                    cell.classList.add('hint');
                    setTimeout(() => cell.classList.remove('hint'), 2000);
                }
            });
        }

        function checkCompletion() {
            if (coloredCells === totalCells) {
                setTimeout(() => {
                    const modal = document.getElementById('completionModal');
                    const elapsed = document.getElementById('timer').textContent;
                    document.getElementById('completionText').textContent =
                        `„Äå${patterns[currentPattern].name}„Äç„Çí${elapsed}„ÅßÂÆåÊàêÔºÅ`;
                    modal.classList.add('show');
                }, 500);
            }
        }

        function closeModal() {
            document.getElementById('completionModal').classList.remove('show');
        }

        function nextArtwork() {
            currentPattern = (currentPattern + 1) % patterns.length;
            loadPattern(currentPattern);
        }

        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // Initialize
        init();
    </script>
</body>
</html>

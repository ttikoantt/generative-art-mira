<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Target Shooter - Mira</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            overflow: hidden;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            touch-action: none;
        }

        #gameCanvas {
            display: block;
            cursor: crosshair;
        }

        #ui {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: none;
            z-index: 10;
        }

        .stat {
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        #startScreen, #gameOverScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 20, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        #gameOverScreen {
            display: none;
        }

        h1 {
            color: #00ff88;
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        h2 {
            color: #ff6b6b;
            font-size: 36px;
            margin-bottom: 20px;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 18px;
            margin-bottom: 40px;
        }

        .final-score {
            color: #ffd93d;
            font-size: 64px;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 0 0 30px rgba(255, 217, 61, 0.5);
        }

        .instructions {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            margin-bottom: 40px;
            text-align: center;
            line-height: 1.8;
        }

        button {
            background: linear-gradient(135deg, #00ff88, 00cc6a);
            color: #1a1a2e;
            border: none;
            padding: 16px 40px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.3);
            pointer-events: auto;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(0, 255, 136, 0.5);
        }

        button:active {
            transform: scale(0.98);
        }

        #fullscreen {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            z-index: 10;
            transition: all 0.3s;
            pointer-events: auto;
        }

        #fullscreen:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .hit-text {
            position: fixed;
            color: #ffd93d;
            font-size: 24px;
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            text-shadow: 0 2px 10px rgba(255, 217, 61, 0.5);
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px) scale(1.5);
            }
        }
    </style>
</head>
<body>
    <div id="ui">
        <div class="stat">Score: <span id="score">0</span></div>
        <div class="stat">Time: <span id="timer">60</span>s</div>
    </div>

    <div id="startScreen">
        <h1>üéØ Target Shooter</h1>
        <div class="subtitle">„Çø„Éº„Ç≤„ÉÉ„Éà„ÇíÁãô„Å£„Å¶ÊíÉ„Å¶ÔºÅ</div>
        <div class="instructions">
            „Çø„Éº„Ç≤„ÉÉ„Éà„ÅåÂãï„ÅçÂõû„Çã<br>
            „ÇØ„É™„ÉÉ„ÇØ„Åß„Éú„Éº„É´„ÇíÁô∫Â∞Ñ<br>
            60Áßí„Åß„Éè„Ç§„Çπ„Ç≥„Ç¢„ÇíÁõÆÊåá„ÅõÔºÅ
        </div>
        <button id="startBtn">„Ç≤„Éº„É†„Çπ„Çø„Éº„Éà</button>
    </div>

    <div id="gameOverScreen">
        <h2>üéÆ Game Over</h2>
        <div class="final-score" id="finalScore">0</div>
        <div class="subtitle" id="resultText">Good Job!</div>
        <button id="restartBtn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶</button>
    </div>

    <button id="fullscreen">‚õ∂ Fullscreen</button>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;

        // „Ç≤„Éº„É†Áä∂ÊÖã
        let gameState = 'start'; // start, playing, gameover
        let score = 0;
        let timeLeft = 60;
        let gameTimer = null;

        // „Çø„Éº„Ç≤„ÉÉ„Éà
        let target = {
            x: width / 2,
            y: height / 2,
            radius: 40,
            vx: 3,
            vy: 2,
            color: '#ff6b6b',
            rings: []
        };

        // „Éú„Éº„É´
        let balls = [];

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´
        let particles = [];

        // „Çø„Éº„Ç≤„ÉÉ„ÉàÂàùÊúüÂåñ
        function initTarget() {
            target.x = width / 2;
            target.y = height / 2;
            target.radius = 40;
            target.vx = (Math.random() - 0.5) * 6;
            target.vy = (Math.random() - 0.5) * 6;
            target.color = `hsl(${Math.random() * 360}, 70%, 60%)`;
            target.rings = [];
            for (let i = 0; i < 3; i++) {
                target.rings.push({
                    offset: i * 0.3,
                    speed: 0.05 + i * 0.02
                });
            }
        }

        // „Ç≤„Éº„É†ÈñãÂßã
        function startGame() {
            gameState = 'playing';
            score = 0;
            timeLeft = 60;
            balls = [];
            particles = [];

            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOverScreen').style.display = 'none';
            document.getElementById('score').textContent = '0';
            document.getElementById('timer').textContent = '60';

            initTarget();

            // „Çø„Ç§„Éû„ÉºÈñãÂßã
            gameTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        // „Ç≤„Éº„É†ÁµÇ‰∫Ü
        function endGame() {
            gameState = 'gameover';
            clearInterval(gameTimer);

            document.getElementById('gameOverScreen').style.display = 'flex';
            document.getElementById('finalScore').textContent = score;

            let resultText = 'Nice Try!';
            if (score >= 50) resultText = 'Amazing!';
            else if (score >= 30) resultText = 'Great Job!';
            else if (score >= 20) resultText = 'Good Job!';

            document.getElementById('resultText').textContent = resultText;
        }

        // „Éú„Éº„É´Áô∫Â∞Ñ
        function shoot(x, y) {
            if (gameState !== 'playing') return;

            // „Çø„Éº„Ç≤„ÉÉ„ÉàÊñπÂêë„Å∏
            const dx = target.x - x;
            const dy = target.y - y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const speed = 12;

            balls.push({
                x: x,
                y: y,
                vx: (dx / distance) * speed,
                vy: (dy / distance) * speed,
                radius: 8
            });
        }

        // „Éí„ÉÉ„Éà„Ç®„Éï„Çß„ÇØ„Éà
        function showHit(x, y, points) {
            const hitText = document.createElement('div');
            hitText.className = 'hit-text';
            hitText.textContent = `+${points}`;
            hitText.style.left = `${x}px`;
            hitText.style.top = `${y}px`;
            document.body.appendChild(hitText);

            setTimeout(() => hitText.remove(), 1000);

            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´
            for (let i = 0; i < 15; i++) {
                const angle = (Math.PI * 2 / 15) * i;
                particles.push({
                    x: x,
                    y: y,
                    vx: Math.cos(angle) * (3 + Math.random() * 3),
                    vy: Math.sin(angle) * (3 + Math.random() * 3),
                    radius: 3 + Math.random() * 4,
                    life: 1,
                    color: target.color
                });
            }
        }

        // „Çø„Éº„Ç≤„ÉÉ„ÉàÊõ¥Êñ∞
        function updateTarget() {
            target.x += target.vx;
            target.y += target.vy;

            // Â£Å„ÅßÂèçÂ∞Ñ
            if (target.x - target.radius < 0 || target.x + target.radius > width) {
                target.vx *= -1;
                target.x = Math.max(target.radius, Math.min(width - target.radius, target.x));
            }
            if (target.y - target.radius < 0 || target.y + target.radius > height) {
                target.vy *= -1;
                target.y = Math.max(target.radius, Math.min(height - target.radius, target.y));
            }

            // „É™„É≥„Ç∞„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            target.rings.forEach(ring => {
                ring.offset += ring.speed;
            });
        }

        // „Éú„Éº„É´Êõ¥Êñ∞
        function updateBalls() {
            for (let i = balls.length - 1; i >= 0; i--) {
                const ball = balls[i];
                ball.x += ball.vx;
                ball.y += ball.vy;

                // ÁîªÈù¢Â§ñ„Å´Âá∫„Åü„ÇâÂâäÈô§
                if (ball.x < -50 || ball.x > width + 50 || ball.y < -50 || ball.y > height + 50) {
                    balls.splice(i, 1);
                    continue;
                }

                // „Çø„Éº„Ç≤„ÉÉ„Éà„Å®„ÅÆË°ùÁ™ÅÂà§ÂÆö
                const dx = ball.x - target.x;
                const dy = ball.y - target.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist < target.radius + ball.radius) {
                    // „Éí„ÉÉ„ÉàÔºÅ
                    score += 10;
                    document.getElementById('score').textContent = score;

                    showHit(target.x, target.y, 10);

                    // „Çø„Éº„Ç≤„ÉÉ„Éà„ÇíÂÜçÁîüÊàê
                    initTarget();
                    balls.splice(i, 1);
                }
            }
        }

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´Êõ¥Êñ∞
        function updateParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.1; // ÈáçÂäõ
                p.life -= 0.02;

                if (p.life <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        // „Çø„Éº„Ç≤„ÉÉ„ÉàÊèèÁîª
        function drawTarget() {
            // Â§ñÂÅ¥„ÅÆ„Ç∞„É≠„Éº
            const glowGradient = ctx.createRadialGradient(
                target.x, target.y, 0,
                target.x, target.y, target.radius * 1.5
            );
            glowGradient.addColorStop(0, target.color.replace('60%', '40%').replace(')', ', 0.3)'));
            glowGradient.addColorStop(1, 'transparent');

            ctx.beginPath();
            ctx.arc(target.x, target.y, target.radius * 1.5, 0, Math.PI * 2);
            ctx.fillStyle = glowGradient;
            ctx.fill();

            // „É°„Ç§„É≥„ÅÆÂÜÜ
            const gradient = ctx.createRadialGradient(
                target.x, target.y, 0,
                target.x, target.y, target.radius
            );
            gradient.addColorStop(0, target.color);
            gradient.addColorStop(1, target.color.replace('60%', '40%'));

            ctx.beginPath();
            ctx.arc(target.x, target.y, target.radius, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();

            // „É™„É≥„Ç∞
            target.rings.forEach((ring, index) => {
                const ringRadius = target.radius * (0.3 + 0.2 * (index + 1));
                const ringAlpha = (Math.sin(ring.offset) + 1) / 2 * 0.5;

                ctx.beginPath();
                ctx.arc(target.x, target.y, ringRadius, 0, Math.PI * 2);
                ctx.strokeStyle = `rgba(255, 255, 255, ${ringAlpha})`;
                ctx.lineWidth = 2;
                ctx.stroke();
            });

            // ‰∏≠ÂøÉ„ÅÆÁÇπ
            ctx.beginPath();
            ctx.arc(target.x, target.y, 5, 0, Math.PI * 2);
            ctx.fillStyle = 'white';
            ctx.fill();
        }

        // „Éú„Éº„É´ÊèèÁîª
        function drawBalls() {
            balls.forEach(ball => {
                // „Éà„É¨„Ç§„É´
                const trailGradient = ctx.createLinearGradient(
                    ball.x - ball.vx * 3, ball.y - ball.vy * 3,
                    ball.x, ball.y
                );
                trailGradient.addColorStop(0, 'rgba(0, 255, 136, 0)');
                trailGradient.addColorStop(1, 'rgba(0, 255, 136, 0.5)');

                ctx.beginPath();
                ctx.moveTo(ball.x - ball.vx * 3, ball.y - ball.vy * 3);
                ctx.lineTo(ball.x, ball.y);
                ctx.strokeStyle = trailGradient;
                ctx.lineWidth = ball.radius;
                ctx.lineCap = 'round';
                ctx.stroke();

                // „Éú„Éº„É´Êú¨‰Ωì
                const ballGradient = ctx.createRadialGradient(
                    ball.x - 2, ball.y - 2, 0,
                    ball.x, ball.y, ball.radius
                );
                ballGradient.addColorStop(0, '#00ff88');
                ballGradient.addColorStop(1, '#00cc6a');

                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
                ctx.fillStyle = ballGradient;
                ctx.fill();
            });
        }

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´ÊèèÁîª
        function drawParticles() {
            particles.forEach(p => {
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.radius * p.life, 0, Math.PI * 2);
                ctx.fillStyle = p.color.replace(')', `, ${p.life})`);
                ctx.fill();
            });
        }

        // „Ç≤„Éº„É†„É´„Éº„Éó
        function gameLoop() {
            // ËÉåÊôØ
            ctx.fillStyle = 'rgba(10, 10, 20, 0.3)';
            ctx.fillRect(0, 0, width, height);

            if (gameState === 'playing') {
                updateTarget();
                updateBalls();
                updateParticles();
            }

            drawTarget();
            drawBalls();
            drawParticles();

            requestAnimationFrame(gameLoop);
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        canvas.addEventListener('click', (e) => {
            shoot(e.clientX, e.clientY);
        });

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            shoot(touch.clientX, touch.clientY);
        }, { passive: false });

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('restartBtn').addEventListener('click', startGame);

        document.getElementById('fullscreen').addEventListener('click', () => {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                document.documentElement.requestFullscreen();
            }
        });

        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        });

        // „Ç≤„Éº„É†„É´„Éº„ÉóÈñãÂßã
        gameLoop();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku Puzzle - Number Logic Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a3a 0%, #2a2a4a 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }

        h1 {
            color: #fff;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-shadow: 0 0 20px rgba(100, 200, 255, 0.5);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 1px;
            background: #4af;
            padding: 3px;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(68, 170, 255, 0.3);
        }

        .cell {
            width: 40px;
            height: 40px;
            background: #1a1a3a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            color: #fff;
        }

        .cell:hover {
            background: #2a2a5a;
        }

        .cell.selected {
            background: #4a4a8a !important;
            box-shadow: inset 0 0 10px rgba(68, 170, 255, 0.5);
        }

        .cell.fixed {
            color: #8af;
            cursor: default;
        }

        .cell.fixed:hover {
            background: #1a1a3a;
        }

        .cell.error {
            background: #a44 !important;
        }

        .cell.highlight {
            background: #3a3a6a;
        }

        /* 3x3 box borders */
        .cell:nth-child(3n) {
            border-right: 2px solid #4af;
        }

        .cell:nth-child(9n) {
            border-right: none;
        }

        .cell:nth-child(n+19):nth-child(-n+27),
        .cell:nth-child(n+46):nth-child(-n+54) {
            border-bottom: 2px solid #4af;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .num-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 8px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            background: linear-gradient(135deg, #3a3a6a, #2a2a4a);
            color: #fff;
            box-shadow: 0 4px 15px rgba(68, 170, 255, 0.2);
        }

        .num-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 255, 0.4);
        }

        .num-btn:active {
            transform: translateY(0);
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            background: linear-gradient(135deg, #4af, #48f);
            color: white;
            box-shadow: 0 4px 15px rgba(68, 170, 255, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(68, 170, 255, 0.5);
        }

        .difficulty {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .diff-btn {
            padding: 8px 15px;
            border: 2px solid #4af;
            border-radius: 8px;
            background: transparent;
            color: #8af;
            cursor: pointer;
            transition: all 0.2s;
        }

        .diff-btn.active {
            background: #4af;
            color: white;
        }

        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 15px;
            background: rgba(100, 200, 255, 0.2);
            border: 1px solid rgba(100, 200, 255, 0.5);
            color: #8af;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 1000;
        }

        .fullscreen-btn:hover {
            background: rgba(100, 200, 255, 0.3);
        }

        .info {
            color: #8af;
            text-align: center;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .message {
            color: #8f8;
            text-align: center;
            margin-top: 10px;
            font-size: 1.1rem;
            min-height: 1.5em;
        }

        @media (max-width: 500px) {
            h1 {
                font-size: 1.4rem;
            }

            .cell {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }

            .num-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">ÂÖ®ÁîªÈù¢</button>
    <h1>üî¢ Sudoku Puzzle - Number Logic Game</h1>

    <div class="game-container">
        <div class="difficulty">
            <button class="diff-btn" onclick="setDifficulty('easy')">Easy</button>
            <button class="diff-btn active" onclick="setDifficulty('medium')">Medium</button>
            <button class="diff-btn" onclick="setDifficulty('hard')">Hard</button>
        </div>

        <div class="grid" id="grid"></div>

        <div class="number-pad">
            <button class="num-btn" onclick="inputNumber(1)">1</button>
            <button class="num-btn" onclick="inputNumber(2)">2</button>
            <button class="num-btn" onclick="inputNumber(3)">3</button>
            <button class="num-btn" onclick="inputNumber(4)">4</button>
            <button class="num-btn" onclick="inputNumber(5)">5</button>
            <button class="num-btn" onclick="inputNumber(6)">6</button>
            <button class="num-btn" onclick="inputNumber(7)">7</button>
            <button class="num-btn" onclick="inputNumber(8)">8</button>
            <button class="num-btn" onclick="inputNumber(9)">9</button>
            <button class="num-btn" onclick="inputNumber(0)">‚úï</button>
        </div>

        <div class="message" id="message"></div>

        <div class="controls">
            <button class="control-btn" onclick="newGame()">üéÆ New Game</button>
            <button class="control-btn" onclick="checkSolution()">‚úì Check</button>
            <button class="control-btn" onclick="showHint()">üí° Hint</button>
        </div>

        <div class="info" id="info">Tap a cell, then tap a number</div>
    </div>

    <script>
        let grid = [];
        let solution = [];
        let selectedCell = null;
        let difficulty = 'medium';
        let hintsUsed = 0;

        const difficulties = {
            easy: 40,
            medium: 50,
            hard: 60
        };

        function createGrid() {
            const gridElement = document.getElementById('grid');
            gridElement.innerHTML = '';

            for (let i = 0; i < 81; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.dataset.index = i;
                cell.addEventListener('click', () => selectCell(i));
                gridElement.appendChild(cell);
            }
        }

        function selectCell(index) {
            const cells = document.querySelectorAll('.cell');
            const cell = cells[index];

            if (cell.classList.contains('fixed')) return;

            cells.forEach(c => c.classList.remove('selected'));

            if (selectedCell === index) {
                selectedCell = null;
            } else {
                selectedCell = index;
                cell.classList.add('selected');
                highlightRelated(index);
            }
        }

        function highlightRelated(index) {
            const cells = document.querySelectorAll('.cell');
            const row = Math.floor(index / 9);
            const col = index % 9;
            const boxRow = Math.floor(row / 3) * 3;
            const boxCol = Math.floor(col / 3) * 3;

            cells.forEach((c, i) => {
                c.classList.remove('highlight');
                const r = Math.floor(i / 9);
                const cc = i % 9;

                if (r === row || cc === col ||
                    (r >= boxRow && r < boxRow + 3 && cc >= boxCol && cc < boxCol + 3)) {
                    c.classList.add('highlight');
                }
            });
        }

        function inputNumber(num) {
            if (selectedCell === null) return;

            const cells = document.querySelectorAll('.cell');
            const cell = cells[selectedCell];

            if (cell.classList.contains('fixed')) return;

            if (num === 0) {
                cell.textContent = '';
                grid[selectedCell] = 0;
            } else {
                cell.textContent = num;
                grid[selectedCell] = num;
            }

            cell.classList.remove('error');
            checkWin();
        }

        function generateSudoku() {
            // Create a valid solved grid
            const base = [
                [1,2,3,4,5,6,7,8,9],
                [4,5,6,7,8,9,1,2,3],
                [7,8,9,1,2,3,4,5,6],
                [2,3,4,5,6,7,8,9,1],
                [5,6,7,8,9,1,2,3,4],
                [8,9,1,2,3,4,5,6,7],
                [3,4,5,6,7,8,9,1,2],
                [6,7,8,9,1,2,3,4,5],
                [9,1,2,3,4,5,6,7,8]
            ];

            // Shuffle rows within bands
            for (let band = 0; band < 3; band++) {
                const rows = [band*3, band*3+1, band*3+2];
                shuffleArray(rows);
                const temp = base[band*3].slice();
                base[band*3] = base[rows[0]].slice();
                base[rows[0]] = temp;
            }

            // Shuffle bands
            const bands = [0, 3, 6];
            shuffleArray(bands);

            // Convert to solution
            solution = base.flat();

            // Create puzzle by removing numbers
            grid = solution.slice();
            const removeCount = difficulties[difficulty];

            const indices = Array.from({length: 81}, (_, i) => i);
            shuffleArray(indices);

            for (let i = 0; i < removeCount; i++) {
                grid[indices[i]] = 0;
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function displayGrid() {
            const cells = document.querySelectorAll('.cell');

            cells.forEach((cell, index) => {
                cell.className = 'cell';
                cell.textContent = '';

                if (grid[index] !== 0) {
                    cell.textContent = grid[index];
                    if (solution[index] === grid[index]) {
                        cell.classList.add('fixed');
                    }
                }
            });

            selectedCell = null;
            hintsUsed = 0;
            updateMessage('');
        }

        function newGame() {
            generateSudoku();
            displayGrid();
        }

        function checkSolution() {
            const cells = document.querySelectorAll('.cell');
            let errors = 0;
            let empty = 0;

            cells.forEach((cell, index) => {
                cell.classList.remove('error');

                if (grid[index] === 0) {
                    empty++;
                } else if (grid[index] !== solution[index]) {
                    cell.classList.add('error');
                    errors++;
                }
            });

            if (empty > 0) {
                updateMessage(`${empty} cells empty. Keep going!`);
            } else if (errors > 0) {
                updateMessage(`${errors} errors found. Try again!`);
            } else {
                updateMessage('üéâ Congratulations! Perfect solution!');
            }
        }

        function showHint() {
            const cells = document.querySelectorAll('.cell');
            const emptyCells = [];

            cells.forEach((cell, index) => {
                if (grid[index] === 0 || grid[index] !== solution[index]) {
                    emptyCells.push(index);
                }
            });

            if (emptyCells.length === 0) {
                updateMessage('Puzzle is already complete!');
                return;
            }

            const randomIndex = emptyCells[Math.floor(Math.random() * emptyCells.length)];
            cells[randomIndex].textContent = solution[randomIndex];
            cells[randomIndex].classList.add('fixed');
            cells[randomIndex].classList.remove('error');
            grid[randomIndex] = solution[randomIndex];

            hintsUsed++;
            updateMessage(`Hint used! (${hintsUsed} total)`);
            checkWin();
        }

        function checkWin() {
            if (grid.every((val, i) => val === solution[i])) {
                updateMessage('üéâ Congratulations! Puzzle solved!');
            }
        }

        function setDifficulty(diff) {
            difficulty = diff;
            document.querySelectorAll('.diff-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            newGame();
        }

        function updateMessage(msg) {
            document.getElementById('message').textContent = msg;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (selectedCell === null) return;

            const num = parseInt(e.key);
            if (num >= 1 && num <= 9) {
                inputNumber(num);
            } else if (e.key === 'Backspace' || e.key === 'Delete' || e.key === '0') {
                inputNumber(0);
            } else if (e.key === 'ArrowUp' && selectedCell >= 9) {
                selectCell(selectedCell - 9);
            } else if (e.key === 'ArrowDown' && selectedCell < 72) {
                selectCell(selectedCell + 9);
            } else if (e.key === 'ArrowLeft' && selectedCell % 9 > 0) {
                selectCell(selectedCell - 1);
            } else if (e.key === 'ArrowRight' && selectedCell % 9 < 8) {
                selectCell(selectedCell + 1);
            }
        });

        // Initialize
        createGrid();
        newGame();
    </script>
</body>
</html>

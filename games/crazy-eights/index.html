<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Eights - Card Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 50%, #1a472a 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            color: #fff;
            overflow-x: hidden;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        .subtitle {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 15px;
            text-align: center;
        }

        .score-board {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 15px 25px;
            margin-bottom: 15px;
            display: flex;
            gap: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
        }

        .game-area {
            width: 100%;
            max-width: 800px;
            margin-bottom: 15px;
        }

        .computer-hand, .player-hand {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            min-height: 100px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hand-label {
            font-size: 0.9rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .cards-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .center-area {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .deck-pile, .discard-pile {
            width: 80px;
            height: 112px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
        }

        .deck-pile:hover {
            transform: scale(1.05);
        }

        .deck-pile {
            background: linear-gradient(135deg, #1e3a5f, #2c5282);
            border: 3px solid #4a90d9;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .deck-pile::after {
            content: 'üé¥';
            font-size: 2rem;
        }

        .discard-pile {
            background: rgba(0, 0, 0, 0.3);
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .card {
            width: 70px;
            height: 100px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            user-select: none;
            position: relative;
            background: #fff;
        }

        .card:hover:not(.card-back) {
            transform: translateY(-10px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .card.playable {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3); }
            50% { box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6); }
        }

        .card-back {
            background: linear-gradient(135deg, #1e3a5f, #2c5282);
            border: 2px solid #4a90d9;
        }

        .card-rank {
            font-size: 1.4rem;
            line-height: 1;
        }

        .card-suit {
            font-size: 1.5rem;
            margin-top: 5px;
        }

        .card-red {
            color: #dc143c;
        }

        .card-black {
            color: #000;
        }

        .suit-hearts, .suit-diamonds {
            color: #dc143c;
        }

        .suit-spades, .suit-clubs {
            color: #000;
        }

        .message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 12px 20px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 0.95rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .message.highlight {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 165, 0, 0.3));
            font-weight: bold;
        }

        .buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .suit-picker {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border-radius: 20px;
            padding: 30px;
            z-index: 1000;
            display: none;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .suit-picker.active {
            display: block;
        }

        .suit-picker h3 {
            text-align: center;
            margin-bottom: 20px;
        }

        .suit-options {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .suit-btn {
            width: 70px;
            height: 90px;
            border-radius: 10px;
            background: #fff;
            border: 3px solid transparent;
            cursor: pointer;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .suit-btn:hover {
            transform: scale(1.1);
            border-color: #ffd700;
        }

        .suit-btn.hearts { color: #dc143c; }
        .suit-btn.diamonds { color: #dc143c; }
        .suit-btn.spades { color: #000; }
        .suit-btn.clubs { color: #000; }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.4rem;
            }

            .card {
                width: 55px;
                height: 80px;
            }

            .card-rank {
                font-size: 1.1rem;
            }

            .card-suit {
                font-size: 1.2rem;
            }

            .deck-pile, .discard-pile {
                width: 65px;
                height: 90px;
            }
        }
    </style>
</head>
<body>
    <h1>üÉè Crazy Eights</h1>
    <p class="subtitle">„Ç´„Éº„Éâ„Ç≤„Éº„É†</p>

    <div class="score-board">
        <div class="score-item">
            <div class="score-label">„ÅÇ„Å™„Åü„ÅÆ„Çπ„Ç≥„Ç¢</div>
            <div class="score-value" id="playerScore">0</div>
        </div>
        <div class="score-item">
            <div class="score-label">„Ç≥„É≥„Éî„É•„Éº„Çø</div>
            <div class="score-value" id="computerScore">0</div>
        </div>
    </div>

    <div class="game-area">
        <div class="computer-hand">
            <div class="hand-label">ü§ñ „Ç≥„É≥„Éî„É•„Éº„Çø„ÅÆÊâãÊú≠: <span id="computerCardCount">7</span>Êûö</div>
            <div class="cards-container" id="computerHand"></div>
        </div>

        <div class="center-area">
            <div class="deck-pile" id="deck" title="„Ç´„Éº„Éâ„ÇíÂºï„Åè"></div>
            <div class="discard-pile" id="discardPile" title="Êç®„Å¶Êú≠"></div>
        </div>

        <div class="player-hand">
            <div class="hand-label">üéÆ „ÅÇ„Å™„Åü„ÅÆÊâãÊú≠</div>
            <div class="cards-container" id="playerHand"></div>
        </div>
    </div>

    <div class="message" id="message">„Ç≤„Éº„É†ÈñãÂßãÔºÅ„Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Âá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>

    <div class="buttons">
        <button class="btn-primary" id="newGame">üîÑ Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†</button>
        <button class="btn-secondary" id="rules">üìñ „É´„Éº„É´</button>
    </div>

    <div class="suit-picker" id="suitPicker">
        <h3>„Çπ„Éº„Éà„ÇíÈÅ∏Êäû</h3>
        <div class="suit-options">
            <button class="suit-btn hearts" data-suit="hearts">‚ô•</button>
            <button class="suit-btn diamonds" data-suit="diamonds">‚ô¶</button>
            <button class="suit-btn spades" data-suit="spades">‚ô†</button>
            <button class="suit-btn clubs" data-suit="clubs">‚ô£</button>
        </div>
    </div>

    <script>
        const suits = ['hearts', 'diamonds', 'spades', 'clubs'];
        const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const suitSymbols = {
            hearts: '‚ô•',
            diamonds: '‚ô¶',
            spades: '‚ô†',
            clubs: '‚ô£'
        };

        let deck = [];
        let playerHand = [];
        let computerHand = [];
        let discardPile = [];
        let currentSuit = null;
        let playerScore = 0;
        let computerScore = 0;
        let isPlayerTurn = true;
        let gameOver = false;

        function createDeck() {
            const newDeck = [];
            for (const suit of suits) {
                for (const rank of ranks) {
                    newDeck.push({ suit, rank });
                }
            }
            return newDeck;
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        function dealCards() {
            deck = shuffleDeck(createDeck());
            playerHand = deck.splice(0, 7);
            computerHand = deck.splice(0, 7);
            discardPile = [deck.splice(0, 1)[0]];
            currentSuit = discardPile[0].suit;
        }

        function getCardValue(card) {
            if (card.rank === '8') return 50;
            if (['J', 'Q', 'K'].includes(card.rank)) return 10;
            if (card.rank === 'A') return 1;
            return parseInt(card.rank);
        }

        function canPlayCard(card, topCard) {
            return card.rank === '8' ||
                   card.suit === currentSuit ||
                   card.rank === topCard.rank;
        }

        function renderCard(card, isBack = false, isPlayable = false) {
            const div = document.createElement('div');
            div.className = 'card';

            if (isBack) {
                div.classList.add('card-back');
            } else {
                const suitClass = card.suit;
                div.classList.add(suitClass);

                if (card.suit === 'hearts' || card.suit === 'diamonds') {
                    div.classList.add('card-red');
                } else {
                    div.classList.add('card-black');
                }

                if (isPlayable) {
                    div.classList.add('playable');
                }

                div.innerHTML = `
                    <div class="card-rank">${card.rank}</div>
                    <div class="card-suit">${suitSymbols[card.suit]}</div>
                `;
            }

            return div;
        }

        function renderHands() {
            const playerHandEl = document.getElementById('playerHand');
            const computerHandEl = document.getElementById('computerHand');
            const discardPileEl = document.getElementById('discardPile');

            playerHandEl.innerHTML = '';
            computerHandEl.innerHTML = '';
            discardPileEl.innerHTML = '';

            // „Éó„É¨„Ç§„É§„Éº„ÅÆÊâãÊú≠
            const topCard = discardPile[discardPile.length - 1];
            playerHand.forEach((card, index) => {
                const isPlayable = isPlayerTurn && !gameOver && canPlayCard(card, topCard);
                const cardEl = renderCard(card, false, isPlayable);
                cardEl.addEventListener('click', () => playCard(index));
                playerHandEl.appendChild(cardEl);
            });

            // „Ç≥„É≥„Éî„É•„Éº„Çø„ÅÆÊâãÊú≠ÔºàË£èÂêë„ÅçÔºâ
            computerHand.forEach(() => {
                const cardEl = renderCard(null, true);
                computerHandEl.appendChild(cardEl);
            });

            // Êç®„Å¶Êú≠„ÅÆ‰∏ÄÁï™‰∏ä
            if (topCard) {
                const topCardEl = renderCard(topCard);
                discardPileEl.appendChild(topCardEl);
            }

            document.getElementById('computerCardCount').textContent = computerHand.length;
        }

        function showMessage(text, highlight = false) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            if (highlight) {
                messageEl.classList.add('highlight');
            } else {
                messageEl.classList.remove('highlight');
            }
        }

        function calculateScore(hand) {
            return hand.reduce((sum, card) => sum + getCardValue(card), 0);
        }

        function endRound(winner) {
            const points = calculateScore(winner === 'player' ? computerHand : playerHand);

            if (winner === 'player') {
                playerScore += points;
                showMessage(`üéâ „ÅÇ„Å™„Åü„ÅÆÂãù„Å°ÔºÅ+${points}„Éù„Ç§„É≥„Éà`, true);
            } else {
                computerScore += points;
                showMessage(`üòî „Ç≥„É≥„Éî„É•„Éº„Çø„ÅÆÂãù„Å°... +${points}„Éù„Ç§„É≥„Éà`, true);
            }

            updateScores();
            gameOver = true;
        }

        function updateScores() {
            document.getElementById('playerScore').textContent = playerScore;
            document.getElementById('computerScore').textContent = computerScore;
        }

        function playCard(index) {
            if (!isPlayerTurn || gameOver) return;

            const card = playerHand[index];
            const topCard = discardPile[discardPile.length - 1];

            if (!canPlayCard(card, topCard)) {
                showMessage('„Åì„ÅÆ„Ç´„Éº„Éâ„ÅØÂá∫„Åõ„Åæ„Åõ„ÇìÔºÅ');
                return;
            }

            playerHand.splice(index, 1);
            discardPile.push(card);

            if (card.rank === '8') {
                showSuitPicker();
                return;
            }

            currentSuit = card.suit;
            renderHands();

            if (playerHand.length === 0) {
                endRound('player');
                return;
            }

            isPlayerTurn = false;
            showMessage('„Ç≥„É≥„Éî„É•„Éº„Çø„ÅÆ„Çø„Éº„É≥...');
            setTimeout(computerTurn, 1000);
        }

        function showSuitPicker() {
            document.getElementById('suitPicker').classList.add('active');
        }

        function hideSuitPicker() {
            document.getElementById('suitPicker').classList.remove('active');
        }

        function selectSuit(suit) {
            currentSuit = suit;
            hideSuitPicker();
            renderHands();

            if (playerHand.length === 0) {
                endRound('player');
                return;
            }

            isPlayerTurn = false;
            showMessage(`„Çπ„Éº„Éà„Çí${suitSymbols[suit]}„Å´Â§âÊõ¥ÔºÅ„Ç≥„É≥„Éî„É•„Éº„Çø„ÅÆ„Çø„Éº„É≥...`);
            setTimeout(computerTurn, 1000);
        }

        function computerTurn() {
            if (gameOver) return;

            const topCard = discardPile[discardPile.length - 1];
            const playableCards = computerHand.filter(card => canPlayCard(card, topCard));

            if (playableCards.length > 0) {
                // ÂÑ™ÂÖàÁöÑ„Å´8„ÇíÂá∫„Åô
                let cardToPlay = playableCards.find(card => card.rank === '8') || playableCards[0];
                const index = computerHand.indexOf(cardToPlay);
                computerHand.splice(index, 1);
                discardPile.push(cardToPlay);

                if (cardToPlay.rank === '8') {
                    // ÊúÄ„ÇÇÂ§ö„ÅèÊåÅ„Å£„Å¶„ÅÑ„Çã„Çπ„Éº„Éà„ÇíÈÅ∏Êäû
                    const suitCounts = {};
                    computerHand.forEach(card => {
                        suitCounts[card.suit] = (suitCounts[card.suit] || 0) + 1;
                    });
                    currentSuit = Object.keys(suitCounts).reduce((a, b) =>
                        suitCounts[a] > suitCounts[b] ? a : b
                    );
                    showMessage(`„Ç≥„É≥„Éî„É•„Éº„Çø„Åå8„ÇíÂá∫„Åó„Å¶„Çπ„Éº„Éà„Çí${suitSymbols[currentSuit]}„Å´Â§âÊõ¥ÔºÅ`);
                } else {
                    currentSuit = cardToPlay.suit;
                    showMessage(`„Ç≥„É≥„Éî„É•„Éº„Çø„Åå${cardToPlay.rank}${suitSymbols[cardToPlay.suit]}„ÇíÂá∫„Åó„Åæ„Åó„Åü`);
                }

                renderHands();

                if (computerHand.length === 0) {
                    endRound('computer');
                    return;
                }
            } else {
                // „Ç´„Éº„Éâ„ÇíÂºï„Åè
                if (deck.length > 0) {
                    computerHand.push(deck.pop());
                    showMessage('„Ç≥„É≥„Éî„É•„Éº„Çø„Åå„Ç´„Éº„Éâ„ÇíÂºï„Åç„Åæ„Åó„Åü');
                    renderHands();
                } else {
                    showMessage('„Ç≥„É≥„Éî„É•„Éº„Çø„ÅØ„Ç´„Éº„Éâ„ÇíÂºï„Åë„Åæ„Åõ„Çì');
                }
            }

            isPlayerTurn = true;
            showMessage('„ÅÇ„Å™„Åü„ÅÆ„Çø„Éº„É≥ÔºÅ');
            renderHands();
        }

        function drawCard() {
            if (!isPlayerTurn || gameOver || deck.length === 0) return;

            const card = deck.pop();
            playerHand.push(card);
            showMessage(`„Ç´„Éº„Éâ„ÇíÂºï„Åç„Åæ„Åó„Åü: ${card.rank}${suitSymbols[card.suit]}`);
            renderHands();

            // Âºï„ÅÑ„Åü„Ç´„Éº„Éâ„ÅåÂá∫„Åõ„Çã„Å™„Çâ„Åù„ÅÆ„Åæ„ÅæÂá∫„Åõ„Çã
            const topCard = discardPile[discardPile.length - 1];
            if (canPlayCard(card, topCard)) {
                showMessage('„Åì„ÅÆ„Ç´„Éº„Éâ„ÅØÂá∫„Åõ„Åæ„ÅôÔºÅ');
            }

            isPlayerTurn = false;
            setTimeout(computerTurn, 500);
        }

        function newGame() {
            dealCards();
            isPlayerTurn = true;
            gameOver = false;
            updateScores();
            renderHands();
            showMessage('Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†ÈñãÂßãÔºÅ„ÅÇ„Å™„Åü„ÅÆ„Çø„Éº„É≥ÔºÅ');
        }

        function showRules() {
            alert(`üìñ Crazy Eights „É´„Éº„É´\n\n` +
                `1. „Éû„Éº„ÇØ„ÅãÊï∞Â≠ó„ÅåÂêà„Åà„Å∞„Ç´„Éº„Éâ„ÇíÂá∫„Åõ„Åæ„Åô\n` +
                `2. 8„ÅØ„Å©„Çì„Å™ÊôÇ„Åß„ÇÇÂá∫„Åõ„Å¶„ÄÅ„Çπ„Éº„Éà„ÇíÂ§âÊõ¥„Åß„Åç„Åæ„Åô\n` +
                `3. Âá∫„Åõ„Çã„Ç´„Éº„Éâ„Åå„Å™„ÅÑÊôÇ„ÅØ„Ç´„Éº„Éâ„ÇíÂºï„Åç„Åæ„Åô\n` +
                `4. ÊúÄÂàù„Å´ÊâãÊú≠„Çí„Å™„Åè„Åó„ÅüÊñπ„ÅåÂãù„Å°\n` +
                `5. Âãù„Å£„ÅüÊñπ„ÅØÁõ∏Êâã„ÅÆÊâãÊú≠„ÅÆ„Éù„Ç§„É≥„Éà„Çí„ÇÇ„Çâ„ÅÑ„Åæ„Åô\n` +
                `   - 8: 50ÁÇπ\n` +
                `   - J/Q/K: 10ÁÇπ\n` +
                `   - A: 1ÁÇπ\n` +
                `   - „Åù„ÅÆ‰ªñ: Êï∞Â≠ó„ÅÆ„Éù„Ç§„É≥„Éà`);
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('deck').addEventListener('click', drawCard);
        document.getElementById('newGame').addEventListener('click', newGame);
        document.getElementById('rules').addEventListener('click', showRules);

        document.querySelectorAll('.suit-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                selectSuit(btn.dataset.suit);
            });
        });

        // „Ç≤„Éº„É†ÈñãÂßã
        newGame();
    </script>
</body>
</html>

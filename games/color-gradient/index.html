<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Gradient - „Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥„Éª„Ç´„É©„Éº„Ç≤„Éº„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0a001a 0%, #1a002e 50%, #0a001e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 600px;
            width: 100%;
        }
        
        h1 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 100, 200, 0.8);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            margin-bottom: 5px;
        }
        
        .stat-value {
            color: #fff;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .game-area {
            position: relative;
            margin-bottom: 20px;
        }
        
        #gradientCanvas {
            border-radius: 20px;
            box-shadow: 
                0 0 50px rgba(255, 100, 200, 0.4),
                0 0 100px rgba(100, 200, 255, 0.3);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        #gradientCanvas:active {
            transform: scale(0.98);
        }
        
        .question {
            color: #fff;
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(135deg, rgba(255, 100, 200, 0.3), rgba(100, 200, 255, 0.3));
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        button:hover {
            background: linear-gradient(135deg, rgba(255, 100, 200, 0.5), rgba(100, 200, 255, 0.5));
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 100, 200, 0.5);
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal {
            background: linear-gradient(135deg, rgba(30, 0, 50, 0.95), rgba(10, 0, 30, 0.95));
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            border: 2px solid rgba(255, 100, 200, 0.5);
            box-shadow: 0 0 50px rgba(255, 100, 200, 0.5);
            max-width: 90%;
            width: 400px;
        }
        
        .modal h2 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 15px;
        }
        
        .modal p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        
        .modal .score {
            font-size: 3rem;
            color: #ffcc00;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(255, 200, 0, 0.8);
        }
        
        .modal .rank {
            font-size: 2rem;
            margin: 15px 0;
        }
        
        .fullscreen-btn {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            z-index: 100;
        }
        
        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 500;
        }
        
        .feedback.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.5);
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">‚õ∂ ÂÖ®ÁîªÈù¢</button>
    
    <div class="container">
        <h1>üé® Color Gradient üé®</h1>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">„Çπ„Ç≥„Ç¢</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">„Éè„Ç§„Çπ„Ç≥„Ç¢</div>
                <div class="stat-value" id="highScore">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">ÊôÇÈñì</div>
                <div class="stat-value" id="timer">60</div>
            </div>
        </div>
        
        <div class="question" id="question">„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥„ÅåÊòé„Çã„Åè„Å™„ÇãÊñπÂêë„ÅØÔºü</div>
        
        <div class="game-area">
            <canvas id="gradientCanvas" width="400" height="100"></canvas>
        </div>
        
        <div class="buttons">
            <button onclick="answer('left')">‚¨Ö Â∑¶„Å∏Êòé„Çã„ÅÑ</button>
            <button onclick="answer('right')">Âè≥„Å∏Êòé„Çã„ÅÑ ‚û°</button>
        </div>
        
        <div class="buttons">
            <button onclick="startGame()" id="startBtn">üéÆ „Ç≤„Éº„É†ÈñãÂßã</button>
            <button onclick="changeDifficulty()" id="difficultyBtn">Èõ£ÊòìÂ∫¶: ÊôÆÈÄö</button>
        </div>
    </div>
    
    <div class="overlay" id="overlay">
        <div class="modal">
            <h2 id="modalTitle">„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº</h2>
            <p>ÊúÄÁµÇ„Çπ„Ç≥„Ç¢</p>
            <div class="score" id="finalScore">0</div>
            <div class="rank" id="rank"></div>
            <p id="newRecord" style="color: #ffcc00; display: none;">üèÜ Êñ∞Ë®òÈå≤ÔºÅ üèÜ</p>
            <button onclick="startGame()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÈÅä„Å∂</button>
        </div>
    </div>
    
    <div class="feedback" id="feedback"></div>
    
    <script>
        const canvas = document.getElementById('gradientCanvas');
        const ctx = canvas.getContext('2d');
        
        let score = 0;
        let highScore = parseInt(localStorage.getItem('gradientHighScore')) || 0;
        let timeLeft = 60;
        let gameActive = false;
        let currentBrighter = '';
        let difficulty = 'normal'; // easy, normal, hard
        let timerInterval;
        
        const difficulties = {
            easy: { minContrast: 40, timeBonus: true },
            normal: { minContrast: 25, timeBonus: false },
            hard: { minContrast: 15, timeBonus: false }
        };
        
        // Convert HSL to RGB
        function hslToRgb(h, s, l) {
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }
        
        // Get luminance (brightness)
        function getLuminance(r, g, b) {
            return 0.299 * r + 0.587 * g + 0.114 * b;
        }
        
        function generateGradient() {
            const hue = Math.random();
            const saturation = 0.5 + Math.random() * 0.5;
            
            let lightness1, lightness2;
            const minContrast = difficulties[difficulty].minContrast;
            
            // Generate two colors with specific luminance difference
            do {
                lightness1 = 0.1 + Math.random() * 0.8;
                lightness2 = 0.1 + Math.random() * 0.8;
            } while (Math.abs(lightness1 - lightness2) * 255 < minContrast);
            
            const [r1, g1, b1] = hslToRgb(hue, saturation, lightness1);
            const [r2, g2, b2] = hslToRgb(hue, saturation, lightness2);
            
            const lum1 = getLuminance(r1, g1, b1);
            const lum2 = getLuminance(r2, g2, b2);
            
            currentBrighter = lum1 > lum2 ? 'left' : 'right';
            
            // Randomize order
            const leftColor = lum1 > lum2 ? `rgb(${r1}, ${g1}, ${b1})` : `rgb(${r2}, ${g2}, ${b2})`;
            const rightColor = lum1 > lum2 ? `rgb(${r2}, ${g2}, ${b2})` : `rgb(${r1}, ${g1}, ${b1})`;
            
            // Draw gradient
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop(0, leftColor);
            gradient.addColorStop(1, rightColor);
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add subtle texture
            for (let i = 0; i < 100; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const alpha = Math.random() * 0.1;
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.fillRect(x, y, 1, 1);
            }
        }
        
        function answer(choice) {
            if (!gameActive) return;
            
            const feedback = document.getElementById('feedback');
            
            if (choice === currentBrighter) {
                score += 10;
                feedback.textContent = '‚≠ï Ê≠£Ëß£ÔºÅ';
                feedback.style.color = '#00ff88';
                showFeedback();
            } else {
                score = Math.max(0, score - 5);
                feedback.textContent = '‚ùå ‰∏çÊ≠£Ëß£';
                feedback.style.color = '#ff4466';
                showFeedback();
            }
            
            updateDisplay();
            generateGradient();
        }
        
        function showFeedback() {
            const feedback = document.getElementById('feedback');
            feedback.classList.add('show');
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 500);
        }
        
        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('highScore').textContent = highScore;
            document.getElementById('timer').textContent = timeLeft;
        }
        
        function startGame() {
            score = 0;
            timeLeft = 60;
            gameActive = true;
            
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('startBtn').textContent = 'üîÑ „ÇÑ„ÇäÁõ¥„Åó';
            
            updateDisplay();
            generateGradient();
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                updateDisplay();
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }
        
        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            
            let isNewRecord = false;
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('gradientHighScore', highScore);
                isNewRecord = true;
            }
            
            // Calculate rank
            let rank, rankEmoji;
            if (score >= 200) {
                rankEmoji = 'üåüüåüüåü';
                rank = 'S+ (Á•ûÁúºÂäõ)';
            } else if (score >= 150) {
                rankEmoji = 'üåüüåü';
                rank = 'S („Éû„Çπ„Çø„Éº)';
            } else if (score >= 100) {
                rankEmoji = '‚≠ê';
                rank = 'A (Á¥†Êô¥„Çâ„Åó„ÅÑ)';
            } else if (score >= 50) {
                rankEmoji = 'üëç';
                rank = 'B (ËâØ„ÅÑ)';
            } else {
                rankEmoji = 'üí™';
                rank = 'C (Á∑¥Áøí„ÅåÂøÖË¶Å)';
            }
            
            document.getElementById('modalTitle').textContent = '„Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºÅ';
            document.getElementById('finalScore').textContent = score;
            document.getElementById('rank').textContent = `${rankEmoji} ${rank}`;
            document.getElementById('newRecord').style.display = isNewRecord ? 'block' : 'none';
            document.getElementById('overlay').classList.add('active');
        }
        
        function changeDifficulty() {
            const cycle = ['easy', 'normal', 'hard'];
            const currentIndex = cycle.indexOf(difficulty);
            difficulty = cycle[(currentIndex + 1) % cycle.length];
            
            const labels = {
                easy: '„Åã„Çì„Åü„Çì',
                normal: 'ÊôÆÈÄö',
                hard: '„ÇÄ„Åö„Åã„Åó„ÅÑ'
            };
            
            document.getElementById('difficultyBtn').textContent = `Èõ£ÊòìÂ∫¶: ${labels[difficulty]}`;
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }
        
        // Initialize
        document.getElementById('highScore').textContent = highScore;
        
        // Draw initial gradient
        generateGradient();
    </script>
</body>
</html>

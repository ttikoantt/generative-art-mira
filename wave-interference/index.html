<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wave Interference Art | Mira</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow: hidden;
        }

        .container {
            text-align: center;
            padding: 20px;
        }

        h1 {
            color: #fff;
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        p {
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 20px;
        }

        #canvas {
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            touch-action: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .info {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            margin-top: 15px;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.5rem;
            }

            #canvas {
                max-width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåä Wave Interference Art</h1>
        <p>„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Ê≥¢Á¥ã„ÇíÁô∫Áîü„Åï„Åõ„Çã</p>
        <canvas id="canvas"></canvas>
        <div class="controls">
            <button onclick="clearWaves()">„ÇØ„É™„Ç¢</button>
            <button onclick="randomMode()">„É©„É≥„ÉÄ„É†ÁîüÊàê</button>
            <button onclick="toggleAuto()">Ëá™Âãï: <span id="autoStatus">OFF</span></button>
        </div>
        <p class="info">„Çø„ÉÉ„Éó/„ÇØ„É™„ÉÉ„ÇØ„ÅßÊ≥¢Á¥ã„ÇíËøΩÂä†</p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Canvas size
        const width = Math.min(600, window.innerWidth - 40);
        const height = Math.min(500, window.innerHeight - 300);
        canvas.width = width;
        canvas.height = height;

        // Wave sources
        let waves = [];
        let autoMode = false;
        let autoInterval = null;
        let animationId = null;

        // Color palettes
        const palettes = [
            ['#00ffff', '#0080ff', '#8000ff'],
            ['#ff6b6b', '#feca57', '#48dbfb'],
            ['#a29bfe', '#74b9ff', '#81ecec'],
            ['#fab1a0', '#ffeaa7', '#dfe6e9'],
            ['#e17055', '#00b894', '#0984e3']
        ];
        let currentPalette = 0;

        // Wave class
        class Wave {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.amplitude = 50;
                this.frequency = 0.05;
                this.phase = 0;
                this.speed = 0.02 + Math.random() * 0.02;
            }

            update() {
                this.phase += this.speed;
                this.amplitude *= 0.999; // Slow decay
            }

            getWaveHeight(px, py) {
                const distance = Math.sqrt((px - this.x) ** 2 + (py - this.y) ** 2);
                const wave = Math.sin(distance * this.frequency - this.phase) * this.amplitude;
                return wave * Math.exp(-distance * 0.003);
            }
        }

        // Get wave interference at point
        function getInterference(px, py) {
            let totalWave = 0;
            for (const wave of waves) {
                totalWave += wave.getWaveHeight(px, py);
            }
            return totalWave;
        }

        // Add wave on click/tap
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            addWave(x, y);
        });

        // Touch support
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            for (const touch of e.touches) {
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                addWave(x, y);
            }
        });

        function addWave(x, y) {
            const palette = palettes[currentPalette];
            const color = palette[wave.length % palette.length];
            waves.push(new Wave(x, y, color));
            currentPalette = (currentPalette + 1) % palettes.length;
        }

        function clearWaves() {
            waves = [];
        }

        function randomMode() {
            clearWaves();
            for (let i = 0; i < 8; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                addWave(x, y);
            }
        }

        function toggleAuto() {
            autoMode = !autoMode;
            document.getElementById('autoStatus').textContent = autoMode ? 'ON' : 'OFF';

            if (autoMode) {
                autoInterval = setInterval(() => {
                    if (waves.length < 15) {
                        const x = Math.random() * width;
                        const y = Math.random() * height;
                        addWave(x, y);
                    }
                }, 1000);
            } else {
                clearInterval(autoInterval);
            }
        }

        // Draw wave interference pattern
        function draw() {
            // Dark background
            ctx.fillStyle = 'rgba(10, 10, 20, 0.3)';
            ctx.fillRect(0, 0, width, height);

            if (waves.length === 0) {
                // Show instructions
                ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('„Çø„ÉÉ„Éó„Åó„Å¶Ê≥¢Á¥ã„ÇíÁîüÊàê', width / 2, height / 2);
                animationId = requestAnimationFrame(draw);
                return;
            }

            // Update waves
            for (const wave of waves) {
                wave.update();
            }

            // Remove weak waves
            waves = waves.filter(w => w.amplitude > 1);

            // Draw interference pattern with lower resolution for performance
            const resolution = 3;
            for (let px = 0; px < width; px += resolution) {
                for (let py = 0; py < height; py += resolution) {
                    const interference = getInterference(px, py);

                    if (Math.abs(interference) > 5) {
                        const intensity = Math.min(255, Math.abs(interference) * 3);
                        const hue = (interference * 5 + Date.now() * 0.02) % 360;
                        ctx.fillStyle = `hsla(${hue}, 80%, 60%, ${intensity / 255})`;
                        ctx.fillRect(px, py, resolution, resolution);
                    }
                }
            }

            // Draw wave sources
            for (const wave of waves) {
                ctx.beginPath();
                ctx.arc(wave.x, wave.y, 5, 0, Math.PI * 2);
                ctx.fillStyle = wave.color;
                ctx.fill();
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            animationId = requestAnimationFrame(draw);
        }

        // Start animation
        draw();

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (animationId) cancelAnimationFrame(animationId);
            if (autoInterval) clearInterval(autoInterval);
        });
    </script>
</body>
</html>

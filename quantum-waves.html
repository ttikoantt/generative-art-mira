<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Quantum Waves - é‡å­æ³¢å‹•å¹²æ¸‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a1a;
            overflow: hidden;
            font-family: 'Courier New', monospace;
        }

        canvas {
            display: block;
            cursor: crosshair;
        }

        .info {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #7dd3fc;
            font-size: 14px;
            background: rgba(10, 10, 26, 0.8);
            padding: 15px 20px;
            border-radius: 10px;
            border: 1px solid rgba(125, 211, 252, 0.3);
            pointer-events: none;
            user-select: none;
        }

        .info h1 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #38bdf8;
        }

        .info p {
            margin: 5px 0;
            opacity: 0.8;
        }

        .fullscreen-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(56, 189, 248, 0.2);
            color: #38bdf8;
            border: 1px solid rgba(56, 189, 248, 0.5);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .fullscreen-btn:hover {
            background: rgba(56, 189, 248, 0.4);
        }

        .clear-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(251, 146, 60, 0.2);
            color: #fb923c;
            border: 1px solid rgba(251, 146, 60, 0.5);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .clear-btn:hover {
            background: rgba(251, 146, 60, 0.4);
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div class="info">
        <h1>ğŸŒŠ Quantum Waves</h1>
        <p>ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã§æ³¢ã®æºã‚’è¿½åŠ </p>
        <p>é‡å­æ³¢å‹•ã®å¹²æ¸‰ãƒ‘ã‚¿ãƒ¼ãƒ³</p>
        <p id="waveCount">æ³¢ã®æ•°: 0</p>
    </div>

    <button class="clear-btn" onclick="clearWaves()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">â›¶ å…¨ç”»é¢</button>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let waves = [];
        let time = 0;
        let waveId = 0;

        // è‰²ç›¸ã®å¾ªç’°
        let baseHue = 0;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resize);
        resize();

        // æ³¢ã®æºã‚¯ãƒ©ã‚¹
        class WaveSource {
            constructor(x, y) {
                this.id = waveId++;
                this.x = x;
                this.y = y;
                this.frequency = 0.5 + Math.random() * 1.5;
                this.amplitude = 50 + Math.random() * 50;
                this.phase = Math.random() * Math.PI * 2;
                this.decay = 0.998;
                this.strength = 1;
                this.hue = (baseHue + waves.length * 30) % 360;
            }

            update() {
                this.phase += this.frequency * 0.1;
                this.strength *= this.decay;
                return this.strength > 0.01;
            }

            getWaveAt(x, y, t) {
                const dx = x - this.x;
                const dy = y - this.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const wavePhase = distance * 0.05 - this.phase - t * 2;
                const decay = Math.max(0, 1 - distance / (width * 0.5));
                return Math.sin(wavePhase) * this.amplitude * decay * this.strength;
            }
        }

        // æ³¢ã®æºã‚’è¿½åŠ 
        function addWave(x, y) {
            waves.push(new WaveSource(x, y));
            baseHue = (baseHue + 20) % 360;
            updateWaveCount();
        }

        // å…¨ã¦ã®æ³¢ã‚’ã‚¯ãƒªã‚¢
        function clearWaves() {
            waves = [];
            waveId = 0;
            baseHue = 0;
            updateWaveCount();
        }

        function updateWaveCount() {
            document.getElementById('waveCount').textContent = `æ³¢ã®æ•°: ${waves.length}`;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        canvas.addEventListener('click', (e) => {
            addWave(e.clientX, e.clientY);
        });

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            for (let touch of e.touches) {
                addWave(touch.clientX, touch.clientY);
            }
        });

        // å…¨ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // æç”»
        function draw() {
            // èƒŒæ™¯ã‚’åŠé€æ˜ã§ä¸Šæ›¸ãï¼ˆãƒˆãƒ¬ã‚¤ãƒ«åŠ¹æœï¼‰
            ctx.fillStyle = 'rgba(10, 10, 26, 0.1)';
            ctx.fillRect(0, 0, width, height);

            // é‡å­æ³¢å‹•ã®å¹²æ¸‰ã‚’è¨ˆç®—ã—ã¦æç”»
            const resolution = 4;
            for (let x = 0; x < width; x += resolution) {
                for (let y = 0; y < height; y += resolution) {
                    let totalWave = 0;
                    let totalHue = 0;
                    let totalWeight = 0;

                    for (let wave of waves) {
                        const waveValue = wave.getWaveAt(x, y, time);
                        const weight = Math.abs(waveValue);
                        totalWave += waveValue;
                        totalHue += wave.hue * weight;
                        totalWeight += weight;
                    }

                    if (totalWeight > 0.1) {
                        const normalizedWave = Math.sin(totalWave * 0.1);
                        const brightness = Math.abs(normalizedWave) * 100;
                        const hue = totalHue / totalWeight;
                        const saturation = 70 + normalizedWave * 30;

                        ctx.fillStyle = `hsla(${hue}, ${saturation}%, ${brightness}%, 0.8)`;
                        ctx.fillRect(x, y, resolution, resolution);
                    }
                }
            }

            // æ³¢ã®æºã‚’æç”»
            for (let wave of waves) {
                const glowSize = 10 + wave.strength * 20;
                const gradient = ctx.createRadialGradient(
                    wave.x, wave.y, 0,
                    wave.x, wave.y, glowSize
                );
                gradient.addColorStop(0, `hsla(${wave.hue}, 100%, 70%, ${wave.strength})`);
                gradient.addColorStop(1, `hsla(${wave.hue}, 100%, 50%, 0)`);
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(wave.x, wave.y, glowSize, 0, Math.PI * 2);
                ctx.fill();
            }

            // æ³¢ã®æºã‚’æ›´æ–°
            waves = waves.filter(wave => wave.update());
            updateWaveCount();

            time += 0.016;
            requestAnimationFrame(draw);
        }

        // åˆæœŸæ³¢ã‚’è¿½åŠ 
        setTimeout(() => {
            addWave(width * 0.3, height * 0.3);
            addWave(width * 0.7, height * 0.7);
            addWave(width * 0.5, height * 0.5);
        }, 100);

        draw();
    </script>
</body>
</html>
